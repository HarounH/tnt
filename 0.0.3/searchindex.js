Search.setIndex({"docnames": ["callbacks", "eval", "fit", "index", "installation", "predict", "project_structure", "torchtnt.data", "torchtnt.loggers", "torchtnt.runner", "torchtnt.utils", "train"], "filenames": ["callbacks.rst", "eval.rst", "fit.rst", "index.rst", "installation.rst", "predict.rst", "project_structure.rst", "torchtnt.data.rst", "torchtnt.loggers.rst", "torchtnt.runner.rst", "torchtnt.utils.rst", "train.rst"], "titles": ["Callbacks", "Evaluate", "Fit", "Welcome to the TorchTNT documentation!", "Installation", "Predict", "Project Structure", "Data", "Loggers", "Runner", "Utils", "Train"], "terms": {"In": [0, 1, 2, 5, 10, 11], "torchtnt": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11], "i": [0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11], "an": [0, 1, 2, 5, 7, 9, 10, 11], "option": [0, 1, 2, 5, 7, 8, 9, 10, 11], "extens": 0, "can": [0, 1, 2, 4, 5, 7, 9, 10, 11], "us": [0, 1, 5, 7, 8, 9, 10, 11], "supplement": 0, "your": [0, 1, 2, 5, 11], "loop": [0, 1, 2, 5, 6, 9, 11], "addit": 0, "function": [0, 1, 2, 7, 9, 10, 11], "good": 0, "candid": 0, "logic": [0, 7], "ar": [0, 6, 7, 9, 10], "ones": 0, "re": 0, "across": [0, 10], "unit": [0, 2, 9], "A": [0, 7, 8, 10], "simpli": 0, "class": [0, 1, 2, 5, 7, 8, 9, 10, 11], "variou": [0, 6], "hook": [0, 1, 2, 5, 11], "call": [0, 1, 2, 5, 8, 9, 10, 11], "dure": [0, 9], "execut": [0, 10], "To": [0, 1, 2, 4, 5, 9, 11], "benefit": [0, 9], "from": [0, 1, 2, 4, 5, 7, 8, 9, 10, 11], "you": [0, 1, 2, 4, 5, 11], "must": [0, 1, 2, 5, 9, 10, 11], "extend": 0, "interfac": [0, 1, 2, 5, 9, 11], "implement": [0, 1, 2, 5, 9, 11], "necessari": [0, 8], "add": [0, 8], "For": [0, 2, 6, 7, 9, 10], "list": [0, 1, 2, 5, 9, 10, 11], "which": [0, 1, 2, 5, 7, 9, 10, 11], "see": [0, 6, 10], "api": 0, "refer": [0, 7], "below": [0, 1, 2, 5, 11], "exampl": [0, 1, 2, 5, 7, 8, 10, 11], "basic": [0, 1, 2, 5, 9, 11], "includ": [0, 1, 2, 5, 7, 9, 10, 11], "user": [0, 1, 2, 5, 7, 9, 11], "print": [0, 7, 10], "state": [0, 1, 2, 5, 9, 10, 11], "point": [0, 9], "runner": [0, 1, 2, 5, 6, 11], "import": [0, 1, 2, 5, 8, 11], "printingcallback": 0, "def": [0, 1, 2, 5, 11], "on_train_start": [0, 9], "self": [0, 1, 2, 5, 11], "trainunit": [0, 9], "ttraindata": [0, 9], "none": [0, 1, 2, 5, 7, 8, 9, 10, 11], "start": [0, 10], "train": [0, 2, 3, 6, 9, 10], "on_train_end": [0, 9], "end": [0, 9], "on_eval_start": [0, 9], "evalunit": [0, 9], "tevaldata": [0, 9], "evalu": [0, 2, 3, 6, 9], "on_eval_end": [0, 9], "on_predict_start": [0, 9], "predictunit": [0, 9], "tpredictdata": [0, 9], "predict": [0, 3, 6, 9], "on_predict_end": [0, 9], "thi": [0, 7, 9, 10], "instanti": 0, "pass": [0, 7, 9, 10], "paramet": [0, 1, 2, 5, 7, 8, 9, 10, 11], "fit": [0, 3, 9], "entri": [0, 9], "printing_callback": 0, "train_unit": [0, 9, 11], "train_dataload": [0, 2, 9], "here": [1, 2, 5, 11], "we": [1, 2, 5, 7, 11], "lai": [1, 2, 5, 11], "out": [1, 2, 5, 11], "step": [1, 2, 5, 8, 9, 10, 11], "need": [1, 2, 5, 11], "configur": [1, 2, 5, 11], "run": [1, 2, 4, 5, 9, 10, 11], "allow": [1, 2, 5, 10, 11], "custom": [1, 2, 5, 7, 9, 10, 11], "when": [1, 2, 5, 7, 10, 11], "creat": [1, 2, 5, 11], "subclass": [1, 2, 5, 7, 9, 11], "eval_step": [1, 2, 9], "method": [1, 2, 5, 9, 11], "ani": [1, 2, 5, 8, 9, 10, 11], "control": [1, 2, 5, 10, 11], "behavior": [1, 2, 5, 11], "differ": [1, 2, 5, 6, 10, 11], "simpl": [1, 2, 5, 6, 8, 11], "": [1, 2, 5, 7, 10, 11], "myevalunit": 1, "batch": [1, 2, 5, 7, 9, 11], "__init__": [1, 2, 5, 11], "modul": [1, 2, 3, 5, 6, 9, 10, 11], "torch": [1, 2, 5, 7, 9, 10, 11], "nn": [1, 2, 5, 9, 11], "super": [1, 2, 5, 11], "data": [1, 2, 3, 5, 6, 8, 9, 10, 11], "input": [1, 2, 5, 7, 10, 11], "target": [1, 2, 5, 11], "output": [1, 2, 5, 9, 11], "loss": [1, 2, 9, 11], "binary_cross_entropy_with_logit": [1, 2, 11], "eval_unit": [1, 9], "The": [1, 2, 5, 6, 9, 10, 11], "take": [1, 2, 5, 9, 11], "argument": 10, "one": [7, 10], "iter": [1, 2, 5, 7, 9, 11], "contain": [6, 7, 9, 10], "pytorch": [1, 2, 3, 4, 5, 6, 7, 9, 10, 11], "dataload": [1, 2, 5, 6, 7, 9, 11], "numpi": [1, 2, 5, 10, 11], "etc": [1, 2, 5, 7, 11], "callback": [1, 2, 3, 5, 9, 11], "describ": [], "sever": 10, "durat": [1, 2, 5, 11], "abov": [1, 2, 5, 11], "init_eval_st": [1, 9], "optim": [1, 2, 5, 9, 11], "lr_schedul": [1, 2, 5, 9, 11], "util": [1, 2, 3, 5, 6, 7, 9, 11], "max_steps_per_epoch": [1, 5, 9], "20": [1, 5], "interleav": [2, 7, 9], "give": 2, "immedi": 2, "feedback": 2, "about": [2, 9], "how": [2, 7, 9], "model": [2, 9, 10], "perform": 2, "while": [2, 7, 10], "train_step": [2, 9, 11], "on_train_epoch_end": [2, 9, 11], "myfitunit": 2, "_lrschedul": [2, 9, 11], "backward": [2, 9, 11], "zero_grad": [2, 11], "learn": [2, 11], "rate": [2, 11], "schedul": [2, 11], "fit_unit": 2, "py": [], "func": [], "eval": 9, "init_fit_st": [2, 9], "eval_dataload": [2, 9], "max_epoch": [2, 9, 11], "4": [2, 7, 10, 11], "tnt": [3, 4], "librari": [3, 10], "tool": 3, "instal": 3, "instruct": 3, "project": 3, "structur": 3, "logger": [3, 6, 10], "index": [3, 7, 10], "search": 3, "page": 3, "pip": 4, "do": 4, "so": 4, "If": [4, 10], "issu": [4, 10], "make": [4, 6, 10], "sure": 4, "first": 4, "also": [4, 7, 10], "latest": 4, "version": [4, 10], "master": 4, "just": 4, "git": 4, "http": [4, 6, 7, 9, 10], "github": [4, 6], "com": [4, 6], "updat": [4, 9], "upgrad": 4, "predict_step": [5, 9], "mypredictunit": 5, "predict_unit": [5, 9], "init_predict_st": [5, 9], "top": 6, "level": 6, "relat": [6, 10], "abstract": [6, 8, 9], "v1": 6, "more": [6, 7, 9, 10], "expans": 6, "support": [6, 7, 10], "pleas": [6, 7], "torchdata": [6, 7], "wrapper": [6, 10], "around": [6, 10], "publish": 6, "log": [6, 8, 9], "metric": [6, 8, 9, 10], "uniform": 6, "lightweight": 6, "framework": 6, "simplifi": 6, "maintain": 6, "grab": 6, "bag": 6, "independ": 6, "alldatasetbatchesiter": 7, "individual_dataload": 7, "map": [7, 8, 10], "str": [7, 8, 9, 10], "union": [7, 8, 9, 10], "iteration_strategi": 7, "alldatasetbatch": 7, "return": [7, 9, 10], "dict": [7, 8, 9, 10], "all": [7, 10], "stop": [7, 9, 10], "mechan": 7, "set": [7, 10], "all_datasets_exhaust": 7, "skip": 7, "over": [7, 9], "finish": 7, "dataset": 7, "three": 7, "1": [7, 9, 10], "till": 7, "largest": 7, "exhaust": [7, 9], "those": 7, "done": [7, 10], "2": [7, 10], "smallest_dataset_exhaust": 7, "onc": [7, 10], "smallest": 7, "ha": [7, 10], "been": [7, 9, 10], "3": [7, 9, 10], "restart_until_all_datasets_exhaust": 7, "until": [7, 9], "restart": 7, "format": 7, "dataloader_1_nam": 7, "batch_obtained_from_dataloader_1": 7, "dataloader_2_nam": 7, "batch_obtained_from_dataloader_2": 7, "name": [7, 8, 10], "kei": [7, 10], "valu": [7, 8, 9, 10], "object": [1, 2, 5, 7, 9, 10, 11], "dataclass": 7, "indic": [7, 10], "loader": 7, "rang": [7, 10], "batch_siz": 7, "b": 7, "15": 7, "5": [7, 10], "all_dataset_batch_strategi": 7, "stopping_mechan": 7, "stoppingmechan": 7, "combined_iter": 7, "item": 7, "tensor": [7, 8, 9, 10], "0": [7, 9, 10], "6": 7, "7": 7, "8": [7, 10], "9": 7, "10": [7, 8], "11": 7, "12": [7, 10], "13": 7, "14": 7, "cudadataprefetch": 7, "data_iter": 7, "devic": [7, 9, 10], "num_prefetch_batch": 7, "int": [7, 8, 9, 10], "prefetch": 7, "move": 7, "them": [7, 9], "load": [7, 10], "host": 7, "copi": [7, 10], "comput": [7, 9], "effect": 7, "construct": 7, "should": [7, 8, 9, 10], "number": [7, 9, 10], "recommend": 7, "leverag": 7, "memori": [7, 8], "pin": 7, "org": [7, 9, 10], "doc": [7, 9, 10], "stabl": [7, 9, 10], "html": [7, 9, 10], "cuda": [7, 9, 10], "data_prefetch": 7, "alreadi": [7, 10], "oper": [7, 10], "dataiterationstrategi": 7, "dataiterationstrategyregistri": 7, "gener": [7, 9, 10], "registri": 7, "provid": [7, 10], "default": [7, 9, 10], "roundrobin": 7, "roundrobiniter": 7, "randomizedbatchsampl": 7, "randomizedbatchsampleriter": 7, "inord": 7, "inorderiter": 7, "classmethod": 7, "get": [7, 10], "type": [7, 10], "multiiter": 7, "singl": [7, 10], "next": 7, "By": 7, "order": [7, 10], "same": [7, 10], "overridden": 7, "repetit": 7, "dataloader_nam": 7, "batch_from_dataload": 7, "in_order_strategi": 7, "multidataload": 7, "iterator_cl": 7, "ignore_empty_data": 7, "bool": [7, 8, 9, 10], "fals": [7, 8, 9], "cycl": 7, "through": 7, "individu": 7, "dictionari": [7, 8], "defin": 7, "instanc": [7, 9], "It": 7, "except": [7, 10], "rais": [7, 10], "beta": 7, "multi": 7, "sourc": [7, 10], "read": [7, 9], "achiev": 7, "mux": 7, "mux_longest": 7, "zip": 7, "document": 7, "detail": [7, 10], "given": [7, 10], "accompani": 7, "particular": 7, "like": [7, 9], "randomli": 7, "sampl": 7, "each": [7, 9, 10], "weight": [7, 9], "after": [7, 8, 9, 10], "chang": [7, 10], "anoth": 7, "randomized_batch_sampl": 7, "via": 7, "robinrobin": 7, "strategi": 7, "two": 7, "round_robin_strategi": 7, "csvlogger": 8, "path": [8, 10], "steps_before_flush": 8, "100": 8, "log_all_rank": 8, "close": 8, "resourc": 8, "flush": 8, "written": 8, "filelogg": 8, "ndarrai": 8, "float": [8, 9, 10], "scalar": 8, "file": 8, "string": [8, 9], "uniqu": 8, "group": [8, 10], "record": [8, 10], "log_dict": 8, "payload": 8, "multipl": [8, 10], "tag": 8, "properti": [8, 9, 10], "inmemorylogg": 8, "buffer": 8, "log_buff": 8, "directli": 8, "access": 8, "jsonlogg": 8, "metriclogg": 8, "arg": [8, 10], "kwarg": [8, 10], "tensorboardlogg": 8, "tensorboard": 8, "accuraci": 8, "23": 8, "56": 8, "writer": 8, "pend": 8, "disk": 8, "cannot": 8, "write": 8, "log_hparam": 8, "hparam": 8, "hyperparamet": 8, "correspond": [8, 10], "log_text": 8, "text": 8, "summari": [8, 10], "identifi": 8, "save": [8, 10], "summarywrit": 8, "scalar_to_float": 8, "autotrainunit": 9, "step_lr_interv": 9, "liter": [9, 10], "epoch": 9, "log_frequency_step": 9, "1000": 9, "precis": 9, "dtype": 9, "gradient_accumulation_step": 9, "detect_anomali": 9, "clip_grad_norm": 9, "clip_grad_valu": 9, "conveni": [9, 10], "who": 9, "stochast": 9, "gradient": 9, "descent": 9, "would": 9, "have": [9, 10], "handl": [9, 10], "specif": 9, "forward": 9, "compute_loss": 9, "update_metr": 9, "log_metr": 9, "Then": 9, "normal": 9, "advanc": 9, "mai": [9, 10], "better": 9, "whether": [9, 10], "everi": 9, "often": 9, "term": 9, "either": [9, 10], "accumul": 9, "enabl": [9, 10], "anomali": 9, "detect": 9, "autograd": 9, "engin": 9, "grad_scal": 9, "amp": 9, "gradscal": 9, "fp16": 9, "num_optimizer_steps_complet": 9, "complet": 9, "tupl": 9, "interv": [9, 10], "code": 9, "base": [9, 10], "mani": 9, "e": 9, "decor": 9, "inference_mod": 9, "improv": [9, 10], "peform": 9, "on_eval_epoch_end": 9, "on_eval_epoch_start": 9, "phasest": 9, "progress": 9, "max_step": 9, "evaluate_every_n_step": 9, "evaluate_every_n_epoch": 9, "phase": 9, "step_output": 9, "on_predict_epoch_end": 9, "on_predict_epoch_start": 9, "num_epochs_complet": 9, "num_steps_complet": 9, "num_steps_completed_in_epoch": 9, "track": 9, "state_dict": [9, 10], "load_state_dict": [9, 10], "checkpoint": [9, 10], "increment_epoch": 9, "increment_step": 9, "entry_point": 9, "entrypoint": 9, "timer": [9, 10], "train_stat": 9, "eval_st": 9, "predict_st": 9, "parent": 9, "up": 9, "active_phas": 9, "activephas": 9, "should_stop": 9, "onli": [9, 10], "termin": 9, "current": [9, 10], "signal": [9, 10], "on_train_epoch_start": 9, "metadata": 9, "initi": [1, 2, 5, 9, 10, 11], "both": [2, 9], "meth": [], "helper": 9, "max": [9, 10], "per": 9, "mean": 9, "max_train_steps_per_epoch": 9, "max_eval_steps_per_epoch": 9, "limit": 9, "infinit": [9, 10], "unless": 9, "init_train_st": [9, 11], "expect": [], "introduc": [], "side": [], "param": [], "cpustat": 10, "_typenam": 10, "_field": 10, "cpu_perc": 10, "cpu_swap_perc": 10, "cpu_vm_perc": 10, "earlystopcheck": 10, "mode": 10, "min": 10, "patienc": 10, "min_delta": 10, "check_finit": 10, "true": 10, "threshold_mod": 10, "ab": 10, "rel": 10, "stopping_threshold": 10, "divergence_threshold": 10, "monitor": 10, "earli": 10, "decreas": 10, "increas": 10, "check": 10, "without": 10, "minimum": 10, "absolut": 10, "qualifi": 10, "best_val": 10, "threshold": 10, "becom": 10, "nan": 10, "delta": 10, "between": 10, "determin": 10, "beyond": 10, "wors": 10, "than": 10, "valueerror": 10, "val": 10, "element": 10, "boolean": 10, "doe": 10, "reset": 10, "back": 10, "reload": 10, "fullsyncperiodictim": 10, "timedelta": 10, "cpu_pg": 10, "processgroup": 10, "measur": 10, "time": 10, "elaps": 10, "rank": 10, "propag": 10, "result": 10, "other": 10, "asynchron": 10, "previou": 10, "avoid": 10, "block": 10, "process": 10, "gpustat": 10, "fan_speed_perc": 10, "memory_free_mb": 10, "memory_used_mb": 10, "temperature_gpu_celsiu": 10, "temperature_memory_celsiu": 10, "utilization_gpu_perc": 10, "utilization_memory_perc": 10, "pgwrapper": 10, "pg": 10, "collect": 10, "consist": 10, "fashion": 10, "regardless": 10, "follow": 10, "scenario": 10, "distribut": 10, "world": 10, "app": 10, "all_gather_object": 10, "obj_list": 10, "obj": 10, "barrier": 10, "broadcast_object_list": 10, "src": 10, "get_rank": 10, "get_world_s": 10, "scatter_object_list": 10, "output_list": 10, "input_list": 10, "rssprofil": 10, "datetim": 10, "microsecond": 10, "100000": 10, "profil": 10, "period": 10, "rss": 10, "resid": 10, "size": 10, "baselin": 10, "store": 10, "rss_deltas_byt": 10, "100m": 10, "byte": 10, "round": 10, "captur": 10, "separ": 10, "thread": 10, "empti": 10, "well": 10, "cumul": 10, "second": 10, "interval_time_second": 10, "most": 10, "recent": 10, "still": 10, "now": 10, "paus": 10, "export": 10, "ad": 10, "total": 10, "action_nam": 10, "yield": 10, "context": 10, "manag": 10, "encapsul": 10, "scope": 10, "action": 10, "under": 10, "what": 10, "enclos": 10, "total_time_second": 10, "sum": 10, "sinc": 10, "last": 10, "all_gather_tensor": 10, "gather": 10, "onto": 10, "broadcast": 10, "work": 10, "dimens": 10, "where": 10, "case": 10, "pad": 10, "trim": 10, "secur": 10, "equal": 10, "workload": 10, "sync": 10, "gathered_result": 10, "copy_data_to_devic": 10, "t": 10, "recurs": 10, "posit": 10, "keyword": 10, "correct": 10, "days_to_sec": 10, "dai": 10, "convert": 10, "get_device_from_env": 10, "environ": 10, "cpu": 10, "gpu": 10, "avail": 10, "within": 10, "reli": 10, "local_rank": 10, "variabl": 10, "made": 10, "program": 10, "launcher": 10, "appropri": 10, "runtimeerror": 10, "outsid": 10, "get_filesystem": 10, "abstractfilesystem": 10, "filesystem": 10, "get_global_rank": 10, "otherwis": 10, "env": 10, "var": 10, "instead": 10, "neither": 10, "condit": 10, "met": 10, "get_nvidia_smi_gpu_stat": 10, "stat": 10, "nvidia": 10, "smi": 10, "filenotfounderror": 10, "command": 10, "found": 10, "get_pet_launch_config": [], "nproc": [], "launchconfig": [], "pet": [], "node": [], "launch": 10, "get_process_group_backend_from_devic": 10, "backend": 10, "get_psutil_cpu_stat": 10, "psutil": 10, "get_python_vers": 10, "runtim": 10, "python": 10, "get_tensor_size_bytes_map": 10, "get_timer_summari": 10, "get_torch_vers": 10, "init_from_env": 10, "device_typ": 10, "pg_backend": 10, "pg_timeout": 10, "1800": 10, "applic": 10, "global": 10, "intend": 10, "begin": 10, "script": 10, "spmd": 10, "style": 10, "timeout": 10, "against": 10, "30": 10, "minut": 10, "is_out_of_cpu_memori": 10, "baseexcept": 10, "oom": 10, "is_out_of_cuda_memori": 10, "is_out_of_memory_error": 10, "due": 10, "error": 10, "messag": 10, "is_torch_version_geq_1_10": 10, "is_torch_version_geq_1_11": 10, "is_torch_version_geq_1_12": 10, "is_torch_version_geq_1_8": 10, "is_torch_version_geq_1_9": 10, "is_window": 10, "window": 10, "system": 10, "measure_rss_delta": 10, "rss_delta": 10, "append": 10, "rank_zero_crit": 10, "rank_zero_debug": 10, "rank_zero_error": 10, "rank_zero_info": 10, "rank_zero_print": 10, "rank_zero_warn": 10, "seed": 10, "determinist": 10, "pseudo": 10, "random": 10, "commonli": 10, "note": 10, "integ": 10, "don": 10, "warn": 10, "nondeterminist": 10, "addition": 10, "cudnn": 10, "benchmark": 10, "disabl": 10, "set_deterministic_debug_mod": 10, "algorithm": 10, "requir": 10, "sync_bool": 10, "coherence_mod": 10, "rank_zero": 10, "synchron": 10, "member": 10, "specifi": 10, "manner": 10, "receiv": 10, "truth": 10, "n": 10, "least": 10, "f": 10, "ratio": 10, "synced_v": 10, "iff": 10, "success": 10, "mytrainunit": 11, "train_epoch": [], "usual": [], "some": [1, 2, 5, 11], "undoc": [], "norm": 9, "clip": 9, "clip_grad_norm_": 9, "clip_grad_value_": 9}, "objects": {"torchtnt": [[7, 0, 0, "-", "data"], [8, 0, 0, "-", "loggers"], [9, 0, 0, "-", "runner"], [10, 0, 0, "-", "utils"]], "torchtnt.data": [[7, 1, 1, "", "AllDatasetBatchesIterator"], [7, 1, 1, "", "CudaDataPrefetcher"], [7, 1, 1, "", "DataIterationStrategy"], [7, 1, 1, "", "DataIterationStrategyRegistry"], [7, 1, 1, "", "InOrderIterator"], [7, 1, 1, "", "MultiDataLoader"], [7, 1, 1, "", "MultiIterator"], [7, 1, 1, "", "RandomizedBatchSamplerIterator"], [7, 1, 1, "", "RoundRobinIterator"]], "torchtnt.data.DataIterationStrategyRegistry": [[7, 2, 1, "", "REGISTRY"], [7, 3, 1, "", "get"]], "torchtnt.data.MultiDataLoader": [[7, 2, 1, "", "ignore_empty_data"], [7, 2, 1, "", "individual_dataloaders"], [7, 2, 1, "", "iteration_strategy"], [7, 2, 1, "", "iterator_cls"]], "torchtnt.loggers": [[8, 1, 1, "", "CSVLogger"], [8, 1, 1, "", "FileLogger"], [8, 1, 1, "", "InMemoryLogger"], [8, 1, 1, "", "JSONLogger"], [8, 1, 1, "", "MetricLogger"], [8, 1, 1, "", "TensorBoardLogger"], [8, 5, 1, "", "scalar_to_float"]], "torchtnt.loggers.CSVLogger": [[8, 3, 1, "", "close"], [8, 3, 1, "", "flush"]], "torchtnt.loggers.FileLogger": [[8, 3, 1, "", "close"], [8, 3, 1, "", "flush"], [8, 3, 1, "", "log"], [8, 3, 1, "", "log_dict"], [8, 4, 1, "", "path"]], "torchtnt.loggers.InMemoryLogger": [[8, 3, 1, "", "close"], [8, 3, 1, "", "flush"], [8, 3, 1, "", "log"], [8, 4, 1, "", "log_buffer"], [8, 3, 1, "", "log_dict"]], "torchtnt.loggers.JSONLogger": [[8, 3, 1, "", "close"], [8, 3, 1, "", "flush"]], "torchtnt.loggers.MetricLogger": [[8, 3, 1, "", "close"], [8, 3, 1, "", "log"], [8, 3, 1, "", "log_dict"]], "torchtnt.loggers.TensorBoardLogger": [[8, 3, 1, "", "close"], [8, 3, 1, "", "flush"], [8, 3, 1, "", "log"], [8, 3, 1, "", "log_dict"], [8, 3, 1, "", "log_hparams"], [8, 3, 1, "", "log_text"], [8, 4, 1, "", "path"], [8, 4, 1, "", "writer"]], "torchtnt.runner": [[9, 1, 1, "", "AutoTrainUnit"], [9, 1, 1, "", "Callback"], [9, 1, 1, "", "EvalUnit"], [9, 1, 1, "", "PhaseState"], [9, 1, 1, "", "PredictUnit"], [9, 1, 1, "", "Progress"], [9, 1, 1, "", "State"], [9, 1, 1, "", "TrainUnit"], [9, 5, 1, "", "evaluate"], [9, 5, 1, "", "fit"], [9, 5, 1, "", "init_eval_state"], [9, 5, 1, "", "init_fit_state"], [9, 5, 1, "", "init_predict_state"], [9, 5, 1, "", "init_train_state"], [9, 5, 1, "", "predict"], [9, 5, 1, "", "train"]], "torchtnt.runner.AutoTrainUnit": [[9, 2, 1, "", "clip_grad_norm"], [9, 2, 1, "", "clip_grad_value"], [9, 3, 1, "", "compute_loss"], [9, 2, 1, "", "detect_anomaly"], [9, 2, 1, "", "device"], [9, 2, 1, "", "grad_scaler"], [9, 2, 1, "", "gradient_accumulation_steps"], [9, 2, 1, "", "log_frequency_steps"], [9, 3, 1, "", "log_metrics"], [9, 2, 1, "", "lr_scheduler"], [9, 2, 1, "", "module"], [9, 4, 1, "id0", "num_optimizer_steps_completed"], [9, 3, 1, "", "on_train_epoch_end"], [9, 2, 1, "", "optimizer"], [9, 2, 1, "", "precision"], [9, 2, 1, "", "step_lr_interval"], [9, 3, 1, "", "train_step"], [9, 3, 1, "", "update_metrics"]], "torchtnt.runner.EvalUnit": [[9, 3, 1, "", "eval_step"], [9, 3, 1, "", "on_eval_end"], [9, 3, 1, "", "on_eval_epoch_end"], [9, 3, 1, "", "on_eval_epoch_start"], [9, 3, 1, "", "on_eval_start"]], "torchtnt.runner.PhaseState": [[9, 4, 1, "", "dataloader"], [9, 4, 1, "", "evaluate_every_n_epochs"], [9, 4, 1, "", "evaluate_every_n_steps"], [9, 4, 1, "", "max_epochs"], [9, 4, 1, "", "max_steps"], [9, 4, 1, "", "max_steps_per_epoch"], [9, 4, 1, "", "progress"], [9, 4, 1, "", "step_output"]], "torchtnt.runner.PredictUnit": [[9, 3, 1, "", "on_predict_end"], [9, 3, 1, "", "on_predict_epoch_end"], [9, 3, 1, "", "on_predict_epoch_start"], [9, 3, 1, "", "on_predict_start"], [9, 3, 1, "", "predict_step"]], "torchtnt.runner.Progress": [[9, 3, 1, "", "increment_epoch"], [9, 3, 1, "", "increment_step"], [9, 3, 1, "", "load_state_dict"], [9, 4, 1, "", "num_epochs_completed"], [9, 4, 1, "", "num_steps_completed"], [9, 4, 1, "", "num_steps_completed_in_epoch"], [9, 3, 1, "", "state_dict"]], "torchtnt.runner.State": [[9, 4, 1, "", "active_phase"], [9, 4, 1, "", "entry_point"], [9, 4, 1, "", "eval_state"], [9, 4, 1, "", "predict_state"], [9, 4, 1, "", "should_stop"], [9, 3, 1, "", "stop"], [9, 4, 1, "", "timer"], [9, 4, 1, "", "train_state"]], "torchtnt.runner.TrainUnit": [[9, 3, 1, "", "on_train_end"], [9, 3, 1, "", "on_train_epoch_end"], [9, 3, 1, "", "on_train_epoch_start"], [9, 3, 1, "", "on_train_start"], [9, 3, 1, "", "train_step"]], "torchtnt.utils": [[10, 1, 1, "", "CPUStats"], [10, 1, 1, "", "EarlyStopChecker"], [10, 1, 1, "", "FullSyncPeriodicTimer"], [10, 1, 1, "", "GPUStats"], [10, 1, 1, "", "PGWrapper"], [10, 1, 1, "", "RSSProfiler"], [10, 1, 1, "", "Timer"], [10, 5, 1, "", "all_gather_tensors"], [10, 5, 1, "", "copy_data_to_device"], [10, 5, 1, "", "days_to_secs"], [10, 5, 1, "", "get_device_from_env"], [10, 5, 1, "", "get_filesystem"], [10, 5, 1, "", "get_global_rank"], [10, 5, 1, "", "get_nvidia_smi_gpu_stats"], [10, 5, 1, "", "get_process_group_backend_from_device"], [10, 5, 1, "", "get_psutil_cpu_stats"], [10, 5, 1, "", "get_python_version"], [10, 5, 1, "", "get_tensor_size_bytes_map"], [10, 5, 1, "", "get_timer_summary"], [10, 5, 1, "", "get_torch_version"], [10, 5, 1, "", "init_from_env"], [10, 5, 1, "", "is_out_of_cpu_memory"], [10, 5, 1, "", "is_out_of_cuda_memory"], [10, 5, 1, "", "is_out_of_memory_error"], [10, 5, 1, "", "is_torch_version_geq_1_10"], [10, 5, 1, "", "is_torch_version_geq_1_11"], [10, 5, 1, "", "is_torch_version_geq_1_12"], [10, 5, 1, "", "is_torch_version_geq_1_8"], [10, 5, 1, "", "is_torch_version_geq_1_9"], [10, 5, 1, "", "is_windows"], [10, 5, 1, "", "measure_rss_deltas"], [10, 5, 1, "", "rank_zero_critical"], [10, 5, 1, "", "rank_zero_debug"], [10, 5, 1, "", "rank_zero_error"], [10, 5, 1, "", "rank_zero_info"], [10, 5, 1, "", "rank_zero_print"], [10, 5, 1, "", "rank_zero_warn"], [10, 5, 1, "", "seed"], [10, 5, 1, "", "sync_bool"]], "torchtnt.utils.CPUStats": [[10, 2, 1, "", "cpu_percent"], [10, 2, 1, "", "cpu_swap_percent"], [10, 2, 1, "", "cpu_vm_percent"]], "torchtnt.utils.EarlyStopChecker": [[10, 3, 1, "", "check"], [10, 4, 1, "", "check_finite"], [10, 4, 1, "", "divergence_threshold"], [10, 3, 1, "", "load_state_dict"], [10, 4, 1, "", "min_delta"], [10, 4, 1, "", "mode"], [10, 4, 1, "", "patience"], [10, 3, 1, "", "reset"], [10, 3, 1, "", "state_dict"], [10, 4, 1, "", "stopping_threshold"], [10, 4, 1, "", "threshold_mode"]], "torchtnt.utils.FullSyncPeriodicTimer": [[10, 3, 1, "", "check"]], "torchtnt.utils.GPUStats": [[10, 2, 1, "", "fan_speed_percent"], [10, 2, 1, "", "memory_free_mb"], [10, 2, 1, "", "memory_used_mb"], [10, 2, 1, "", "temperature_gpu_celsius"], [10, 2, 1, "", "temperature_memory_celsius"], [10, 2, 1, "", "utilization_gpu_percent"], [10, 2, 1, "", "utilization_memory_percent"]], "torchtnt.utils.PGWrapper": [[10, 3, 1, "", "all_gather_object"], [10, 3, 1, "", "barrier"], [10, 3, 1, "", "broadcast_object_list"], [10, 3, 1, "", "get_rank"], [10, 3, 1, "", "get_world_size"], [10, 3, 1, "", "scatter_object_list"]], "torchtnt.utils.RSSProfiler": [[10, 2, 1, "", "interval"], [10, 3, 1, "", "profile"], [10, 3, 1, "", "reset"], [10, 2, 1, "", "rss_deltas_bytes"]], "torchtnt.utils.Timer": [[10, 4, 1, "", "interval_time_seconds"], [10, 3, 1, "", "load_state_dict"], [10, 4, 1, "", "paused"], [10, 3, 1, "", "reset"], [10, 3, 1, "", "start"], [10, 3, 1, "", "state_dict"], [10, 3, 1, "", "stop"], [10, 3, 1, "", "time"], [10, 4, 1, "", "total_time_seconds"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:attribute", "3": "py:method", "4": "py:property", "5": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "attribute", "Python attribute"], "3": ["py", "method", "Python method"], "4": ["py", "property", "Python property"], "5": ["py", "function", "Python function"]}, "titleterms": {"callback": 0, "evalu": 1, "evalunit": [1, 2], "entri": [1, 2, 5, 11], "point": [1, 2, 5, 11], "fit": 2, "trainunit": [2, 11], "welcom": 3, "torchtnt": 3, "document": 3, "api": 3, "overview": 3, "runner": [3, 9], "indic": 3, "tabl": 3, "instal": 4, "predict": 5, "predictunit": 5, "project": 6, "structur": 6, "data": 7, "logger": 8, "util": 10, "train": 11}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})