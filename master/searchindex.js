Search.setIndex({"docnames": ["framework/auto_unit", "framework/callbacks", "framework/eval", "framework/fit", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter", "framework/generated/torchtnt.framework.callbacks.GarbageCollector", "framework/generated/torchtnt.framework.callbacks.Lambda", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor", "framework/generated/torchtnt.framework.callbacks.ModuleSummary", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver", "framework/predict", "framework/state", "framework/train", "framework/unit", "index", "installation", "project_structure", "utils/data", "utils/loggers", "utils/utils"], "filenames": ["framework/auto_unit.rst", "framework/callbacks.rst", "framework/eval.rst", "framework/fit.rst", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter.rst", "framework/generated/torchtnt.framework.callbacks.GarbageCollector.rst", "framework/generated/torchtnt.framework.callbacks.Lambda.rst", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor.rst", "framework/generated/torchtnt.framework.callbacks.ModuleSummary.rst", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler.rst", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar.rst", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor.rst", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver.rst", "framework/predict.rst", "framework/state.rst", "framework/train.rst", "framework/unit.rst", "index.rst", "installation.rst", "project_structure.rst", "utils/data.rst", "utils/loggers.rst", "utils/utils.rst"], "titles": ["AutoUnit", "Callbacks", "Evaluate", "Fit", "BaseCSVWriter", "GarbageCollector", "Lambda", "LearningRateMonitor", "ModuleSummary", "PyTorchProfiler", "TQDMProgressBar", "TensorBoardParameterMonitor", "TorchSnapshotSaver", "Predict", "State", "Train", "Unit", "Welcome to the TorchTNT documentation!", "Installation", "Project Structure", "Data", "Loggers", "Utils"], "terms": {"class": [0, 1, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 20, 21, 22], "torchtnt": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 19, 20, 21, 22], "framework": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 19], "modul": [0, 8, 11, 16, 19, 22], "optim": [0, 7, 16], "lr_schedul": [0, 16], "option": [0, 2, 3, 6, 8, 12, 13, 14, 15, 16, 20, 21, 22], "lrschedul": [0, 22], "none": [0, 2, 3, 6, 8, 12, 13, 14, 15, 16, 20, 21, 22], "step_lr_interv": 0, "liter": [0, 22], "step": [0, 2, 3, 4, 5, 6, 10, 12, 13, 14, 15, 16, 21, 22], "epoch": [0, 2, 3, 6, 7, 12, 13, 15], "devic": [0, 20, 22], "log_frequency_step": 0, "int": [0, 2, 3, 5, 8, 10, 12, 13, 14, 15, 20, 21, 22], "1000": 0, "precis": [0, 22], "union": [0, 6, 7, 11, 20, 21, 22], "str": [0, 4, 7, 8, 12, 14, 20, 21, 22], "dtype": 0, "gradient_accumulation_step": 0, "1": [0, 3, 10, 20, 22], "detect_anomali": 0, "bool": [0, 12, 14, 20, 21, 22], "fals": [0, 20, 21], "clip_grad_norm": 0, "float": [0, 21, 22], "clip_grad_valu": 0, "swa_param": 0, "swaparam": 0, "torchdynamo_param": 0, "torchdynamoparam": 0, "The": [0, 2, 3, 4, 5, 8, 13, 15, 16, 22], "conveni": [0, 5, 14, 16, 22], "user": [0, 9, 12, 20], "who": 0, "ar": [0, 1, 12, 16, 19, 20, 22], "train": [0, 3, 5, 6, 10, 12, 14, 16, 17, 19, 22], "stochast": 0, "gradient": [0, 5], "descent": 0, "would": 0, "like": [0, 20], "have": [0, 12, 22], "model": [0, 5, 16, 22], "handl": [0, 12, 22], "them": [0, 20], "subclass": [0, 3, 20], "trainunit": [0, 3, 6, 12, 15], "evalunit": [0, 2, 3, 6], "predictunit": [0, 6, 13], "implement": [0, 2, 3, 4, 13, 15, 16], "train_step": [0, 3, 15, 16], "eval_step": [0, 2, 3, 16], "predict_step": [0, 13, 16], "For": [0, 12, 20, 22], "run": [0, 2, 3, 5, 6, 13, 15, 16, 18, 22], "forward": 0, "pass": [0, 20, 22], "part": 0, "loss": [0, 16], "comput": [0, 20], "backward": [0, 16], "onli": [0, 10, 14, 22], "To": [0, 18], "benefit": 0, "from": [0, 6, 8, 12, 16, 18, 20, 21, 22], "must": [0, 4, 5, 22], "compute_loss": 0, "method": [0, 12], "update_metr": 0, "log_metr": 0, "Then": 0, "us": [0, 1, 2, 3, 8, 9, 12, 13, 15, 16, 20, 21, 22], "evalu": [0, 3, 6, 10, 12, 16, 17, 19], "predict": [0, 4, 6, 10, 14, 16, 17, 19], "fit": [0, 12, 16, 17], "entri": [0, 12], "point": [0, 5], "normal": 0, "more": [0, 12, 20, 22], "advanc": 0, "custom": [0, 20, 22], "directli": [0, 21], "interfac": [0, 4, 16], "param": [0, 7], "dure": [0, 2, 3, 4, 6, 12, 13, 14, 15], "whether": [0, 14, 22], "everi": 0, "default": [0, 4, 5, 8, 12, 20, 22], "how": [0, 3, 20], "often": [0, 3], "log": [0, 7, 8, 11, 19, 21], "term": [0, 3], "paramet": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 20, 21, 22], "updat": [0, 5, 10, 18], "either": [0, 7, 11, 22], "string": [0, 4, 21], "torch": [0, 9, 11, 16, 20, 22], "mani": 0, "batch": [0, 16, 20, 22], "accumul": 0, "over": [0, 2, 13, 20], "enabl": [0, 22], "anomali": 0, "detect": 0, "autograd": 0, "engin": 0, "http": [0, 8, 9, 11, 12, 18, 20, 22], "pytorch": [0, 8, 9, 11, 12, 17, 18, 20, 22], "org": [0, 8, 9, 11, 12, 20, 22], "doc": [0, 9, 11, 20, 22], "stabl": [0, 8, 9, 11, 20, 22], "html": [0, 9, 11, 12, 20, 22], "max": [0, 2, 3, 13, 15, 22], "norm": [0, 22], "clip": 0, "gener": [0, 8, 12, 20, 22], "nn": [0, 16], "util": [0, 11, 12, 17, 19, 20, 21], "clip_grad_norm_": 0, "valu": [0, 20, 21, 22], "clip_grad_value_": 0, "weight": [0, 20], "averag": 0, "torchdynamo": 0, "grad_scal": 0, "cuda": [0, 20, 22], "amp": 0, "gradscal": 0, "fp16": 0, "num_optimizer_steps_complet": 0, "number": [0, 2, 3, 5, 10, 12, 13, 15, 20, 22], "complet": [0, 14], "support": [0, 20, 22], "avail": [0, 22], "2": [0, 20, 22], "0": [0, 10, 14, 20, 22], "higher": 0, "abstract": [0, 16, 19, 21], "state": [0, 2, 3, 6, 12, 13, 15, 16, 17, 22], "data": [0, 2, 13, 16, 19, 21, 22], "tdata": 0, "tupl": [0, 8, 16], "tensor": [0, 16, 20, 21, 22], "ani": [0, 8, 14, 16, 21, 22], "should": [0, 4, 12, 20, 21, 22], "thi": [0, 4, 5, 12, 13, 20, 22], "call": [0, 21, 22], "object": [0, 2, 3, 13, 15, 20, 22], "which": [0, 1, 2, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 19, 20, 22], "return": [0, 2, 3, 13, 15, 16, 20, 22], "contain": [0, 2, 3, 13, 14, 15, 19, 20, 22], "output": [0, 4, 16], "can": [0, 3, 5, 13, 14, 16, 18, 20, 22], "decor": [0, 16], "inference_mod": [0, 16], "improv": [0, 5, 16, 22], "peform": [0, 16], "interv": [0, 22], "code": [0, 5, 9, 16], "metric": [0, 19, 21, 22], "base": [0, 5, 16, 22], "been": [0, 20, 22], "on_train_epoch_end": [0, 6, 16], "on_eval_epoch_end": [0, 6, 16], "i": [0, 22], "e": [0, 16], "end": [0, 6, 12, 14], "an": [0, 2, 3, 4, 6, 7, 13, 15, 16, 20, 22], "move_data_to_devic": 0, "overrid": 0, "copi": [0, 20, 22], "start": [0, 6, 22], "By": [0, 4, 5, 12, 20], "function": [0, 2, 3, 6, 8, 13, 15, 16, 20, 22], "copy_data_to_devic": [0, 22], "A": [0, 4, 5, 6, 7, 8, 9, 10, 11, 12, 20, 21, 22], "properti": [0, 14, 21, 22], "on_train_end": [0, 6, 16], "note": [0, 22], "swa": 0, "super": [0, 16], "we": [1, 5, 20], "offer": [1, 12, 16], "sever": [1, 16, 22], "pre": 1, "written": [1, 4, 21], "readi": 1, "out": 1, "box": 1, "init_eval_st": 2, "dataload": [2, 3, 6, 12, 13, 14, 15, 20], "iter": [2, 3, 13, 14, 15, 20], "tevaldata": [2, 3, 6, 16], "max_steps_per_epoch": [2, 13, 14, 15], "helper": [2, 3, 13, 15], "initi": [2, 3, 10, 13, 15, 22], "per": [2, 3, 13, 15], "mean": [2, 3, 13, 15], "until": [2, 3, 13, 15, 20], "exhaust": [2, 3, 13, 15, 20], "metadata": [2, 3, 13, 15], "eval_unit": 2, "callback": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 17], "list": [2, 3, 4, 7, 8, 12, 13, 15, 22], "take": [2, 5, 12, 13, 15], "loop": [2, 3, 5, 6, 13, 14, 15, 19], "about": [2, 3, 13, 15], "instanc": [2, 3, 11, 13, 14, 15, 20], "init_fit_st": 3, "train_dataload": 3, "ttraindata": [3, 6, 12, 15, 16], "eval_dataload": 3, "max_epoch": [3, 14, 15], "max_step": [3, 14, 15], "max_train_steps_per_epoch": 3, "max_eval_steps_per_epoch": 3, "evaluate_every_n_step": [3, 14], "evaluate_every_n_epoch": [3, 14], "limit": [3, 15], "infinit": [3, 15, 22], "unless": [3, 15], "stop": [3, 14, 15, 20, 22], "unit": [3, 6, 12, 17], "interleav": [3, 16, 20], "both": 3, "header_row": 4, "dir_path": 4, "delimit": 4, "t": [4, 22], "filenam": 4, "csv": 4, "write": [4, 21], "file": [4, 21], "provid": [4, 12, 20, 22], "simplifi": [4, 19], "extend": [4, 16], "get_step_output_row": 4, "desir": 4, "row": 4, "each": [4, 5, 6, 7, 14, 20, 22], "across": [4, 5, 12, 22], "all": [4, 5, 8, 12, 20, 22], "process": [4, 5, 12, 22], "same": [4, 5, 12, 16, 20, 22], "match": 4, "column": 4, "name": [4, 8, 12, 20, 21, 22], "defin": [4, 20], "directori": [4, 12], "path": [4, 12, 21, 22], "where": [4, 22], "save": [4, 12, 21, 22], "separ": [4, 22], "one": [4, 20, 22], "tab": 4, "step_interv": 5, "perform": 5, "period": [5, 12, 22], "synchron": [5, 22], "garbag": 5, "collect": [5, 22], "In": [5, 16, 22], "fulli": 5, "distribut": [5, 10, 22], "program": [5, 22], "multipl": [5, 21, 22], "These": [5, 16], "need": [5, 16], "commun": 5, "other": [5, 22], "especi": 5, "overal": 5, "execut": [5, 22], "therefor": 5, "gate": 5, "slowest": 5, "As": 5, "result": [5, 22], "s": [5, 12, 20, 22], "import": [5, 6, 16, 21], "roughli": 5, "amount": 5, "time": [5, 22], "its": 5, "otherwis": [5, 22], "straggler": 5, "python": [5, 22], "automat": 5, "trigger": 5, "differ": [5, 16, 19, 22], "creat": 5, "possibl": 5, "make": [5, 18, 22], "configur": 5, "lead": 5, "frequenc": [5, 12], "tune": 5, "applic": [5, 12, 22], "hand": 5, "befor": 5, "on_except": 6, "callabl": [6, 8], "tpredictdata": [6, 13, 16], "baseexcept": [6, 22], "on_train_start": [6, 12, 16], "on_train_epoch_start": [6, 16], "on_train_step_start": 6, "on_train_step_end": 6, "on_eval_start": [6, 16], "on_eval_epoch_start": [6, 16], "on_eval_step_start": 6, "on_eval_step_end": 6, "on_eval_end": [6, 16], "on_predict_start": [6, 16], "on_predict_epoch_start": [6, 16], "on_predict_step_start": 6, "on_predict_step_end": 6, "on_predict_epoch_end": [6, 16], "on_predict_end": [6, 16], "accept": 6, "when": [6, 8, 20, 22], "except": [6, 20, 22], "occur": 6, "eval": [6, 12, 14], "exampl": [6, 16, 20, 21, 22], "mydataload": 6, "myunit": [6, 16], "def": [6, 16], "print_on_step_start": 6, "print": [6, 8, 20, 22], "f": [6, 22], "eval_st": [6, 14], "progress": [6, 10, 12], "num_steps_complet": [6, 14], "lambda_cb": 6, "arg": [6, 8, 21, 22], "logger": [7, 11, 22], "metriclogg": [7, 21], "logging_interv": 7, "learn": [7, 16], "rate": [7, 10, 16], "track": [7, 14], "schedul": [7, 16], "group": [7, 21, 22], "associ": 7, "max_depth": 8, "type": [8, 16, 20, 22], "process_fn": 8, "torchev": 8, "tool": [8, 17], "module_summari": 8, "_log_module_summary_t": 8, "module_input": 8, "mutablemap": 8, "dict": [8, 14, 20, 21, 22], "summari": [8, 21, 22], "requir": [8, 22], "maximum": 8, "depth": 8, "keep": 8, "tabl": 8, "map": [8, 20, 21, 22], "kwarg": [8, 21, 22], "want": [8, 12], "flop": 8, "activ": 8, "size": [8, 22], "etc": [8, 20], "rais": [8, 20, 22], "runtimeerror": [8, 22], "If": [8, 12, 18, 22], "instal": [8, 17], "profil": [9, 22], "context": [9, 22], "manag": [9, 12, 22], "refresh_r": 10, "bar": 10, "visual": 10, "It": [10, 20], "rank": [10, 22], "environ": [10, 22], "determin": [10, 22], "get": [10, 20, 22], "tensorboardlogg": [11, 21], "summarywrit": [11, 21], "histogram": 11, "tensorboard": [11, 21], "writer": [11, 21], "dirpath": 12, "save_every_n_train_step": 12, "save_every_n_epoch": 12, "replic": 12, "torchsnapshot": 12, "supplement": 12, "appstatemixin": 12, "random": [12, 22], "also": [12, 18, 20, 22], "parent": [12, 14], "snapshot": 12, "intra": 12, "glob": 12, "pattern": 12, "kei": [12, 20, 22], "indic": [12, 20, 22], "inform": [12, 22], "see": [12, 22], "main": [12, 19], "api_refer": 12, "valid": 12, "collis": 12, "app": [12, 22], "static": 12, "restor": 12, "restore_train_progress": 12, "true": [12, 22], "restore_train_dataload": 12, "restore_eval_progress": 12, "sinc": [12, 22], "There": 12, "addit": 12, "flag": 12, "skip": [12, 20], "load": [12, 20, 22], "init_predict_st": 13, "predict_unit": 13, "entry_point": 14, "entrypoint": 14, "timer": [14, 22], "train_stat": 14, "predict_st": 14, "up": 14, "3": [14, 20, 22], "phase": [14, 16], "active_phas": 14, "activephas": 14, "should_stop": 14, "read": [14, 20], "termin": 14, "after": [14, 20, 21, 22], "current": [14, 22], "signal": [14, 22], "is_last_batch": 14, "step_output": 14, "num_epochs_complet": 14, "num_steps_completed_in_epoch": 14, "includ": [14, 19, 20, 22], "state_dict": [14, 22], "load_state_dict": [14, 22], "checkpoint": [14, 22], "increment_epoch": 14, "increment_step": 14, "init_train_st": 15, "train_unit": 15, "concept": 16, "repres": 16, "primari": 16, "place": 16, "organ": 16, "your": 16, "three": [16, 20], "mutual": 16, "exclus": 16, "case": [16, 22], "some": 16, "under": [16, 22], "g": 16, "you": [16, 18], "plan": 16, "refer": [16, 20], "here": 16, "__init__": 16, "self": 16, "_lrschedul": 16, "input": [16, 20, 22], "target": 16, "binary_cross_entropy_with_logit": 16, "zero_grad": 16, "my_unit": 16, "tnt": [17, 18], "librari": [17, 22], "project": 17, "structur": 17, "autounit": 17, "pip": 18, "do": 18, "so": 18, "issu": [18, 22], "sure": 18, "first": 18, "latest": 18, "version": [18, 22], "master": 18, "just": 18, "git": 18, "github": 18, "com": 18, "upgrad": 18, "ha": [19, 20, 22], "two": [19, 20, 22], "compon": 19, "top": 19, "level": 19, "repo": 19, "lightweight": 19, "maintain": 19, "grab": 19, "bag": 19, "variou": 19, "independ": 19, "relat": [19, 22], "wrapper": [19, 22], "around": [19, 22], "publish": 19, "alldatasetbatchesiter": 20, "individual_dataload": 20, "iteration_strategi": 20, "alldatasetbatch": 20, "mechan": 20, "set": [20, 22], "all_datasets_exhaust": 20, "finish": 20, "dataset": 20, "till": 20, "largest": 20, "while": [20, 22], "those": 20, "done": [20, 22], "smallest_dataset_exhaust": 20, "onc": [20, 22], "smallest": 20, "restart_until_all_datasets_exhaust": 20, "restart": 20, "format": 20, "dataloader_1_nam": 20, "batch_obtained_from_dataloader_1": 20, "dataloader_2_nam": 20, "batch_obtained_from_dataloader_2": 20, "dataclass": 20, "loader": 20, "rang": [20, 22], "4": [20, 22], "batch_siz": 20, "b": 20, "15": 20, "5": [20, 22], "all_dataset_batch_strategi": 20, "stopping_mechan": 20, "stoppingmechan": 20, "combined_iter": 20, "item": 20, "6": 20, "7": 20, "8": [20, 22], "9": 20, "10": [20, 21], "11": 20, "12": [20, 22], "13": 20, "14": 20, "cudadataprefetch": 20, "data_iter": 20, "num_prefetch_batch": 20, "prefetch": 20, "move": 20, "host": 20, "effect": 20, "construct": 20, "recommend": 20, "leverag": 20, "memori": [20, 21], "pin": 20, "data_prefetch": 20, "alreadi": [20, 22], "oper": [20, 22], "dataiterationstrategi": 20, "dataiterationstrategyregistri": 20, "registri": 20, "roundrobin": 20, "roundrobiniter": 20, "randomizedbatchsampl": 20, "randomizedbatchsampleriter": 20, "inord": 20, "inorderiter": 20, "classmethod": 20, "multiiter": 20, "singl": [20, 22], "next": 20, "order": [20, 22], "overridden": 20, "repetit": 20, "dataloader_nam": 20, "batch_from_dataload": 20, "in_order_strategi": 20, "multidataload": 20, "iterator_cl": 20, "ignore_empty_data": 20, "cycl": 20, "through": 20, "individu": 20, "dictionari": [20, 21], "logic": 20, "torchdata": 20, "beta": 20, "index": [20, 22], "multi": 20, "sourc": [20, 22], "achiev": 20, "mux": 20, "mux_longest": 20, "zip": 20, "pleas": 20, "document": 20, "detail": [20, 22], "given": [20, 22], "accompani": 20, "particular": 20, "randomli": 20, "sampl": 20, "chang": [20, 22], "anoth": 20, "randomized_batch_sampl": 20, "via": 20, "robinrobin": 20, "strategi": 20, "round_robin_strategi": 20, "csvlogger": 21, "steps_before_flush": 21, "100": 21, "log_all_rank": 21, "close": 21, "resourc": 21, "flush": 21, "necessari": 21, "filelogg": 21, "ndarrai": 21, "scalar": 21, "uniqu": 21, "record": [21, 22], "log_dict": 21, "payload": 21, "add": 21, "tag": 21, "inmemorylogg": 21, "buffer": 21, "log_buff": 21, "access": 21, "jsonlogg": 21, "simpl": 21, "accuraci": 21, "23": 21, "56": 21, "pend": 21, "disk": 21, "cannot": 21, "log_hparam": 21, "hparam": 21, "hyperparamet": 21, "correspond": [21, 22], "log_text": 21, "text": 21, "identifi": 21, "scalar_to_float": 21, "cpustat": 22, "_typenam": 22, "_field": 22, "cpu_perc": 22, "cpu_swap_perc": 22, "cpu_vm_perc": 22, "earlystopcheck": 22, "mode": 22, "min": 22, "patienc": 22, "min_delta": 22, "check_finit": 22, "threshold_mod": 22, "ab": 22, "rel": 22, "stopping_threshold": 22, "divergence_threshold": 22, "monitor": 22, "earli": 22, "decreas": 22, "increas": 22, "check": 22, "without": 22, "minimum": 22, "absolut": 22, "qualifi": 22, "improvement_threshold": 22, "best_val": 22, "threshold": 22, "becom": 22, "nan": 22, "delta": 22, "between": 22, "beyond": 22, "wors": 22, "than": 22, "valueerror": 22, "val": 22, "element": 22, "boolean": 22, "doe": 22, "reset": 22, "back": 22, "reload": 22, "fullsyncperiodictim": 22, "timedelta": 22, "cpu_pg": 22, "processgroup": 22, "measur": 22, "elaps": 22, "propag": 22, "asynchron": 22, "previou": 22, "avoid": 22, "block": 22, "gpustat": 22, "fan_speed_perc": 22, "memory_free_mb": 22, "memory_used_mb": 22, "temperature_gpu_celsiu": 22, "temperature_memory_celsiu": 22, "utilization_gpu_perc": 22, "utilization_memory_perc": 22, "pgwrapper": 22, "pg": 22, "allow": 22, "consist": 22, "fashion": 22, "regardless": 22, "follow": 22, "scenario": 22, "world": 22, "all_gather_object": 22, "obj_list": 22, "obj": 22, "barrier": 22, "broadcast_object_list": 22, "src": 22, "get_rank": 22, "get_world_s": 22, "scatter_object_list": 22, "output_list": 22, "input_list": 22, "rssprofil": 22, "datetim": 22, "microsecond": 22, "100000": 22, "rss": 22, "resid": 22, "baselin": 22, "store": 22, "rss_deltas_byt": 22, "100m": 22, "byte": 22, "round": 22, "captur": 22, "thread": 22, "empti": 22, "tlrschedul": 22, "alia": 22, "well": 22, "cumul": 22, "second": 22, "interval_time_second": 22, "most": 22, "recent": 22, "still": 22, "now": 22, "paus": 22, "export": 22, "ad": 22, "total": 22, "action_nam": 22, "yield": 22, "encapsul": 22, "scope": 22, "action": 22, "what": 22, "enclos": 22, "total_time_second": 22, "sum": 22, "last": 22, "all_gather_tensor": 22, "gather": 22, "onto": 22, "broadcast": 22, "work": 22, "dimens": 22, "mai": 22, "pad": 22, "trim": 22, "secur": 22, "equal": 22, "workload": 22, "sync": 22, "gathered_result": 22, "recurs": 22, "posit": 22, "argument": 22, "keyword": 22, "correct": 22, "days_to_sec": 22, "dai": 22, "convert": 22, "get_device_from_env": 22, "cpu": 22, "gpu": 22, "within": 22, "reli": 22, "local_rank": 22, "variabl": 22, "made": 22, "launcher": 22, "appropri": 22, "outsid": 22, "get_filesystem": 22, "abstractfilesystem": 22, "filesystem": 22, "get_global_rank": 22, "env": 22, "var": 22, "instead": 22, "neither": 22, "condit": 22, "met": 22, "get_nvidia_smi_gpu_stat": 22, "stat": 22, "nvidia": 22, "smi": 22, "filenotfounderror": 22, "command": 22, "found": 22, "get_process_group_backend_from_devic": 22, "backend": 22, "get_psutil_cpu_stat": 22, "psutil": 22, "get_python_vers": 22, "runtim": 22, "get_tensor_size_bytes_map": 22, "get_timer_summari": 22, "get_torch_vers": 22, "init_from_env": 22, "device_typ": 22, "pg_backend": 22, "pg_timeout": 22, "1800": 22, "float32_matmul_precis": 22, "high": 22, "global": 22, "launch": 22, "intend": 22, "begin": 22, "script": 22, "spmd": 22, "style": 22, "timeout": 22, "against": 22, "30": 22, "minut": 22, "matrix": 22, "is_out_of_cpu_memori": 22, "oom": 22, "is_out_of_cuda_memori": 22, "is_out_of_memory_error": 22, "due": 22, "error": 22, "messag": 22, "is_torch_version_ge_1_13_1": 22, "is_torch_version_geq_1_10": 22, "is_torch_version_geq_1_11": 22, "is_torch_version_geq_1_12": 22, "is_torch_version_geq_1_13": 22, "is_torch_version_geq_1_14": 22, "is_torch_version_geq_1_8": 22, "is_torch_version_geq_1_9": 22, "is_torch_version_geq_2_0": 22, "is_window": 22, "Is": 22, "window": 22, "system": 22, "maybe_enable_tf32": 22, "condition": 22, "float32": 22, "datatyp": 22, "measure_rss_delta": 22, "rss_delta": 22, "append": 22, "rank_zero_crit": 22, "rank_zero_debug": 22, "rank_zero_error": 22, "rank_zero_info": 22, "rank_zero_print": 22, "rank_zero_warn": 22, "seed": 22, "determinist": 22, "pseudo": 22, "commonli": 22, "numpi": 22, "integ": 22, "control": 22, "don": 22, "warn": 22, "nondeterminist": 22, "addition": 22, "cudnn": 22, "benchmark": 22, "disabl": 22, "set_deterministic_debug_mod": 22, "algorithm": 22, "sync_bool": 22, "coherence_mod": 22, "rank_zero": 22, "member": 22, "specifi": 22, "manner": 22, "receiv": 22, "truth": 22, "n": 22, "least": 22, "ratio": 22, "synced_v": 22, "iff": 22, "success": 22, "transfer_batch_norm_stat": 22, "src_modul": 22, "dst_modul": 22, "transfer": 22, "statist": 22, "transfer_weight": 22}, "objects": {"torchtnt.framework": [[0, 0, 1, "", "AutoUnit"], [16, 0, 1, "", "EvalUnit"], [14, 0, 1, "", "PhaseState"], [16, 0, 1, "", "PredictUnit"], [14, 0, 1, "", "Progress"], [14, 0, 1, "", "State"], [16, 0, 1, "", "TrainUnit"], [1, 4, 0, "-", "callback"], [2, 5, 1, "", "evaluate"], [3, 5, 1, "", "fit"], [2, 5, 1, "", "init_eval_state"], [3, 5, 1, "", "init_fit_state"], [13, 5, 1, "", "init_predict_state"], [15, 5, 1, "", "init_train_state"], [13, 5, 1, "", "predict"], [15, 5, 1, "", "train"]], "torchtnt.framework.AutoUnit": [[0, 1, 1, "", "clip_grad_norm"], [0, 1, 1, "", "clip_grad_value"], [0, 2, 1, "", "compute_loss"], [0, 1, 1, "", "detect_anomaly"], [0, 1, 1, "", "device"], [0, 2, 1, "", "eval_step"], [0, 1, 1, "", "grad_scaler"], [0, 1, 1, "", "gradient_accumulation_steps"], [0, 1, 1, "", "log_frequency_steps"], [0, 2, 1, "", "log_metrics"], [0, 1, 1, "", "lr_scheduler"], [0, 1, 1, "", "module"], [0, 2, 1, "", "move_data_to_device"], [0, 3, 1, "id0", "num_optimizer_steps_completed"], [0, 2, 1, "", "on_eval_epoch_end"], [0, 2, 1, "", "on_train_end"], [0, 2, 1, "", "on_train_epoch_end"], [0, 1, 1, "", "optimizer"], [0, 1, 1, "", "precision"], [0, 2, 1, "", "predict_step"], [0, 1, 1, "", "step_lr_interval"], [0, 1, 1, "", "swa_params"], [0, 1, 1, "", "torchdynamo_params"], [0, 2, 1, "", "train_step"], [0, 2, 1, "", "update_metrics"]], "torchtnt.framework.EvalUnit": [[16, 2, 1, "", "eval_step"], [16, 2, 1, "", "on_eval_end"], [16, 2, 1, "", "on_eval_epoch_end"], [16, 2, 1, "", "on_eval_epoch_start"], [16, 2, 1, "", "on_eval_start"]], "torchtnt.framework.PhaseState": [[14, 3, 1, "", "dataloader"], [14, 3, 1, "", "evaluate_every_n_epochs"], [14, 3, 1, "", "evaluate_every_n_steps"], [14, 3, 1, "", "is_last_batch"], [14, 3, 1, "", "max_epochs"], [14, 3, 1, "", "max_steps"], [14, 3, 1, "", "max_steps_per_epoch"], [14, 3, 1, "", "progress"], [14, 3, 1, "", "step_output"]], "torchtnt.framework.PredictUnit": [[16, 2, 1, "", "on_predict_end"], [16, 2, 1, "", "on_predict_epoch_end"], [16, 2, 1, "", "on_predict_epoch_start"], [16, 2, 1, "", "on_predict_start"], [16, 2, 1, "", "predict_step"]], "torchtnt.framework.Progress": [[14, 2, 1, "", "increment_epoch"], [14, 2, 1, "", "increment_step"], [14, 2, 1, "", "load_state_dict"], [14, 3, 1, "", "num_epochs_completed"], [14, 3, 1, "", "num_steps_completed"], [14, 3, 1, "", "num_steps_completed_in_epoch"], [14, 2, 1, "", "state_dict"]], "torchtnt.framework.State": [[14, 3, 1, "", "active_phase"], [14, 3, 1, "", "entry_point"], [14, 3, 1, "", "eval_state"], [14, 3, 1, "", "predict_state"], [14, 3, 1, "", "should_stop"], [14, 2, 1, "", "stop"], [14, 3, 1, "", "timer"], [14, 3, 1, "", "train_state"]], "torchtnt.framework.TrainUnit": [[16, 2, 1, "", "on_train_end"], [16, 2, 1, "", "on_train_epoch_end"], [16, 2, 1, "", "on_train_epoch_start"], [16, 2, 1, "", "on_train_start"], [16, 2, 1, "", "train_step"]], "torchtnt.framework.callback": [[1, 0, 1, "", "Callback"]], "torchtnt.framework.callbacks": [[4, 0, 1, "", "BaseCSVWriter"], [5, 0, 1, "", "GarbageCollector"], [6, 0, 1, "", "Lambda"], [7, 0, 1, "", "LearningRateMonitor"], [8, 0, 1, "", "ModuleSummary"], [9, 0, 1, "", "PyTorchProfiler"], [10, 0, 1, "", "TQDMProgressBar"], [11, 0, 1, "", "TensorBoardParameterMonitor"], [12, 0, 1, "", "TorchSnapshotSaver"]], "torchtnt.framework.callbacks.TorchSnapshotSaver": [[12, 2, 1, "", "on_train_start"], [12, 2, 1, "", "restore"]], "torchtnt": [[22, 4, 0, "-", "utils"]], "torchtnt.utils": [[22, 0, 1, "", "CPUStats"], [22, 0, 1, "", "EarlyStopChecker"], [22, 0, 1, "", "FullSyncPeriodicTimer"], [22, 0, 1, "", "GPUStats"], [22, 0, 1, "", "PGWrapper"], [22, 0, 1, "", "RSSProfiler"], [22, 1, 1, "", "TLRScheduler"], [22, 0, 1, "", "Timer"], [22, 5, 1, "", "all_gather_tensors"], [22, 5, 1, "", "copy_data_to_device"], [20, 4, 0, "-", "data"], [22, 5, 1, "", "days_to_secs"], [22, 5, 1, "", "get_device_from_env"], [22, 5, 1, "", "get_filesystem"], [22, 5, 1, "", "get_global_rank"], [22, 5, 1, "", "get_nvidia_smi_gpu_stats"], [22, 5, 1, "", "get_process_group_backend_from_device"], [22, 5, 1, "", "get_psutil_cpu_stats"], [22, 5, 1, "", "get_python_version"], [22, 5, 1, "", "get_tensor_size_bytes_map"], [22, 5, 1, "", "get_timer_summary"], [22, 5, 1, "", "get_torch_version"], [22, 5, 1, "", "init_from_env"], [22, 5, 1, "", "is_out_of_cpu_memory"], [22, 5, 1, "", "is_out_of_cuda_memory"], [22, 5, 1, "", "is_out_of_memory_error"], [22, 5, 1, "", "is_torch_version_ge_1_13_1"], [22, 5, 1, "", "is_torch_version_geq_1_10"], [22, 5, 1, "", "is_torch_version_geq_1_11"], [22, 5, 1, "", "is_torch_version_geq_1_12"], [22, 5, 1, "", "is_torch_version_geq_1_13"], [22, 5, 1, "", "is_torch_version_geq_1_14"], [22, 5, 1, "", "is_torch_version_geq_1_8"], [22, 5, 1, "", "is_torch_version_geq_1_9"], [22, 5, 1, "", "is_torch_version_geq_2_0"], [22, 5, 1, "", "is_windows"], [21, 4, 0, "-", "loggers"], [22, 5, 1, "", "maybe_enable_tf32"], [22, 5, 1, "", "measure_rss_deltas"], [22, 5, 1, "", "rank_zero_critical"], [22, 5, 1, "", "rank_zero_debug"], [22, 5, 1, "", "rank_zero_error"], [22, 5, 1, "", "rank_zero_info"], [22, 5, 1, "", "rank_zero_print"], [22, 5, 1, "", "rank_zero_warn"], [22, 5, 1, "", "seed"], [22, 5, 1, "", "sync_bool"], [22, 5, 1, "", "transfer_batch_norm_stats"], [22, 5, 1, "", "transfer_weights"]], "torchtnt.utils.CPUStats": [[22, 1, 1, "", "cpu_percent"], [22, 1, 1, "", "cpu_swap_percent"], [22, 1, 1, "", "cpu_vm_percent"]], "torchtnt.utils.EarlyStopChecker": [[22, 2, 1, "", "check"], [22, 3, 1, "", "check_finite"], [22, 3, 1, "", "divergence_threshold"], [22, 2, 1, "", "load_state_dict"], [22, 3, 1, "", "min_delta"], [22, 3, 1, "", "mode"], [22, 3, 1, "", "patience"], [22, 2, 1, "", "reset"], [22, 2, 1, "", "state_dict"], [22, 3, 1, "", "stopping_threshold"], [22, 3, 1, "", "threshold_mode"]], "torchtnt.utils.FullSyncPeriodicTimer": [[22, 2, 1, "", "check"]], "torchtnt.utils.GPUStats": [[22, 1, 1, "", "fan_speed_percent"], [22, 1, 1, "", "memory_free_mb"], [22, 1, 1, "", "memory_used_mb"], [22, 1, 1, "", "temperature_gpu_celsius"], [22, 1, 1, "", "temperature_memory_celsius"], [22, 1, 1, "", "utilization_gpu_percent"], [22, 1, 1, "", "utilization_memory_percent"]], "torchtnt.utils.PGWrapper": [[22, 2, 1, "", "all_gather_object"], [22, 2, 1, "", "barrier"], [22, 2, 1, "", "broadcast_object_list"], [22, 2, 1, "", "get_rank"], [22, 2, 1, "", "get_world_size"], [22, 2, 1, "", "scatter_object_list"]], "torchtnt.utils.RSSProfiler": [[22, 1, 1, "", "interval"], [22, 2, 1, "", "profile"], [22, 2, 1, "", "reset"], [22, 1, 1, "", "rss_deltas_bytes"]], "torchtnt.utils.Timer": [[22, 3, 1, "", "interval_time_seconds"], [22, 2, 1, "", "load_state_dict"], [22, 3, 1, "", "paused"], [22, 2, 1, "", "reset"], [22, 2, 1, "", "start"], [22, 2, 1, "", "state_dict"], [22, 2, 1, "", "stop"], [22, 2, 1, "", "time"], [22, 3, 1, "", "total_time_seconds"]], "torchtnt.utils.data": [[20, 0, 1, "", "AllDatasetBatchesIterator"], [20, 0, 1, "", "CudaDataPrefetcher"], [20, 0, 1, "", "DataIterationStrategy"], [20, 0, 1, "", "DataIterationStrategyRegistry"], [20, 0, 1, "", "InOrderIterator"], [20, 0, 1, "", "MultiDataLoader"], [20, 0, 1, "", "MultiIterator"], [20, 0, 1, "", "RandomizedBatchSamplerIterator"], [20, 0, 1, "", "RoundRobinIterator"]], "torchtnt.utils.data.DataIterationStrategyRegistry": [[20, 1, 1, "", "REGISTRY"], [20, 2, 1, "", "get"]], "torchtnt.utils.data.MultiDataLoader": [[20, 1, 1, "", "ignore_empty_data"], [20, 1, 1, "", "individual_dataloaders"], [20, 1, 1, "", "iteration_strategy"], [20, 1, 1, "", "iterator_cls"]], "torchtnt.utils.loggers": [[21, 0, 1, "", "CSVLogger"], [21, 0, 1, "", "FileLogger"], [21, 0, 1, "", "InMemoryLogger"], [21, 0, 1, "", "JSONLogger"], [21, 0, 1, "", "MetricLogger"], [21, 0, 1, "", "TensorBoardLogger"], [21, 5, 1, "", "scalar_to_float"]], "torchtnt.utils.loggers.CSVLogger": [[21, 2, 1, "", "close"], [21, 2, 1, "", "flush"]], "torchtnt.utils.loggers.FileLogger": [[21, 2, 1, "", "close"], [21, 2, 1, "", "flush"], [21, 2, 1, "", "log"], [21, 2, 1, "", "log_dict"], [21, 3, 1, "", "path"]], "torchtnt.utils.loggers.InMemoryLogger": [[21, 2, 1, "", "close"], [21, 2, 1, "", "flush"], [21, 2, 1, "", "log"], [21, 3, 1, "", "log_buffer"], [21, 2, 1, "", "log_dict"]], "torchtnt.utils.loggers.JSONLogger": [[21, 2, 1, "", "close"], [21, 2, 1, "", "flush"]], "torchtnt.utils.loggers.MetricLogger": [[21, 2, 1, "", "close"], [21, 2, 1, "", "log"], [21, 2, 1, "", "log_dict"]], "torchtnt.utils.loggers.TensorBoardLogger": [[21, 2, 1, "", "close"], [21, 2, 1, "", "flush"], [21, 2, 1, "", "log"], [21, 2, 1, "", "log_dict"], [21, 2, 1, "", "log_hparams"], [21, 2, 1, "", "log_text"], [21, 3, 1, "", "path"], [21, 3, 1, "", "writer"]]}, "objtypes": {"0": "py:class", "1": "py:attribute", "2": "py:method", "3": "py:property", "4": "py:module", "5": "py:function"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "attribute", "Python attribute"], "2": ["py", "method", "Python method"], "3": ["py", "property", "Python property"], "4": ["py", "module", "Python module"], "5": ["py", "function", "Python function"]}, "titleterms": {"autounit": 0, "callback": 1, "built": 1, "evalu": 2, "entri": [2, 3, 13, 15], "point": [2, 3, 13, 15], "fit": 3, "basecsvwrit": 4, "garbagecollector": 5, "lambda": 6, "learningratemonitor": 7, "modulesummari": 8, "pytorchprofil": 9, "tqdmprogressbar": 10, "tensorboardparametermonitor": 11, "torchsnapshotsav": 12, "predict": 13, "state": 14, "phasest": 14, "progress": 14, "train": 15, "unit": 16, "trainunit": 16, "evalunit": 16, "predictunit": 16, "combin": 16, "multipl": 16, "welcom": 17, "torchtnt": 17, "document": 17, "overview": 17, "framework": 17, "instal": 18, "project": 19, "structur": 19, "data": 20, "logger": 21, "util": 22}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})