Search.setIndex({"docnames": ["callbacks", "eval", "fit", "generated/torchtnt.framework.callbacks.BaseCSVWriter", "generated/torchtnt.framework.callbacks.GarbageCollector", "generated/torchtnt.framework.callbacks.Lambda", "generated/torchtnt.framework.callbacks.LearningRateMonitor", "generated/torchtnt.framework.callbacks.ModuleSummary", "generated/torchtnt.framework.callbacks.PyTorchProfiler", "generated/torchtnt.framework.callbacks.TQDMProgressBar", "generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor", "generated/torchtnt.framework.callbacks.TorchSnapshotSaver", "index", "installation", "predict", "project_structure", "torchtnt.framework", "torchtnt.utils", "train"], "filenames": ["callbacks.rst", "eval.rst", "fit.rst", "generated/torchtnt.framework.callbacks.BaseCSVWriter.rst", "generated/torchtnt.framework.callbacks.GarbageCollector.rst", "generated/torchtnt.framework.callbacks.Lambda.rst", "generated/torchtnt.framework.callbacks.LearningRateMonitor.rst", "generated/torchtnt.framework.callbacks.ModuleSummary.rst", "generated/torchtnt.framework.callbacks.PyTorchProfiler.rst", "generated/torchtnt.framework.callbacks.TQDMProgressBar.rst", "generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor.rst", "generated/torchtnt.framework.callbacks.TorchSnapshotSaver.rst", "index.rst", "installation.rst", "predict.rst", "project_structure.rst", "torchtnt.framework.rst", "torchtnt.utils.rst", "train.rst"], "titles": ["Callbacks", "Evaluate", "Fit", "BaseCSVWriter", "GarbageCollector", "Lambda", "LearningRateMonitor", "ModuleSummary", "PyTorchProfiler", "TQDMProgressBar", "TensorBoardParameterMonitor", "TorchSnapshotSaver", "Welcome to the TorchTNT documentation!", "Installation", "Predict", "Project Structure", "Framework", "Utils", "Train"], "terms": {"In": [0, 1, 2, 4, 14, 17, 18], "torchtnt": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18], "an": [0, 1, 2, 3, 5, 6, 14, 16, 17, 18], "option": [0, 1, 2, 5, 7, 11, 14, 16, 17, 18], "extens": 0, "can": [0, 1, 2, 4, 13, 14, 16, 17, 18], "supplement": [0, 11], "loop": [0, 1, 2, 4, 5, 14, 15, 16, 18], "addit": [0, 11], "function": [0, 1, 2, 5, 7, 16, 17, 18], "good": 0, "candid": 0, "logic": [0, 17], "ar": [0, 11, 15, 16, 17], "ones": 0, "re": 0, "across": [0, 3, 4, 11, 17], "unit": [0, 2, 5, 11, 16], "A": [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 16, 17], "simpli": 0, "class": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 16, 17, 18], "variou": [0, 15], "hook": [0, 1, 2, 14, 18], "call": [0, 1, 2, 14, 16, 17, 18], "dure": [0, 3, 5, 11, 16], "execut": [0, 4, 17], "below": [0, 1, 2, 14, 18], "exampl": [0, 1, 2, 5, 14, 17, 18], "basic": [0, 1, 2, 14, 18], "which": [0, 1, 2, 6, 7, 8, 9, 10, 11, 14, 15, 16, 17, 18], "print": [0, 5, 7, 17], "messag": [0, 17], "point": [0, 4, 16], "from": [0, 1, 2, 5, 7, 11, 13, 14, 16, 17, 18], "framework": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 15, 18], "import": [0, 1, 2, 4, 5, 14, 17, 18], "state": [0, 1, 2, 5, 11, 14, 16, 17, 18], "tevalunit": 0, "tpredictunit": 0, "ttrainunit": 0, "printingcallback": 0, "def": [0, 1, 2, 5, 14, 18], "on_train_start": [0, 5, 11, 16], "self": [0, 1, 2, 14, 18], "none": [0, 1, 2, 5, 7, 11, 14, 16, 17, 18], "start": [0, 5, 16, 17], "train": [0, 2, 4, 5, 9, 11, 12, 15, 16, 17], "on_train_end": [0, 5, 16], "end": [0, 5, 11, 16], "on_eval_start": [0, 5, 16], "evalu": [0, 2, 5, 9, 11, 12, 15, 16], "on_eval_end": [0, 5, 16], "on_predict_start": [0, 5, 16], "predict": [0, 3, 5, 9, 12, 15, 16], "on_predict_end": [0, 5, 16], "To": [0, 1, 2, 13, 14, 16, 18], "instanti": 0, "pass": [0, 16, 17], "paramet": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 16, 17, 18], "fit": [0, 11, 12, 16], "entri": [0, 11, 16], "printing_callback": 0, "train_unit": [0, 16, 18], "train_dataload": [0, 2, 16], "we": [0, 1, 2, 4, 14, 17, 18], "offer": [0, 11], "sever": [0, 17], "pre": 0, "written": [0, 3, 17], "readi": 0, "out": [0, 1, 2, 14, 18], "box": 0, "subclass": [0, 1, 2, 14, 16, 17, 18], "add": [0, 17], "code": [0, 4, 8, 16], "here": [1, 2, 14, 18], "lai": [1, 2, 14, 18], "step": [1, 2, 3, 4, 5, 9, 11, 14, 16, 17, 18], "need": [1, 2, 4, 14, 18], "configur": [1, 2, 4, 14, 18], "run": [1, 2, 4, 5, 13, 14, 16, 17, 18], "your": [1, 2, 14, 18], "interfac": [1, 2, 3, 14, 16, 18], "allow": [1, 2, 14, 17, 18], "you": [1, 2, 13, 14, 18], "custom": [1, 2, 14, 16, 17, 18], "when": [1, 2, 5, 7, 14, 17, 18], "us": [1, 7, 8, 11, 14, 16, 17, 18], "must": [1, 2, 3, 4, 14, 16, 17, 18], "creat": [1, 2, 4, 14, 18], "implement": [1, 2, 3, 14, 16, 18], "eval_step": [1, 2, 16], "method": [1, 2, 11, 14, 16, 18], "ani": [1, 2, 7, 14, 16, 17, 18], "control": [1, 2, 14, 17, 18], "behavior": [1, 2, 14, 18], "differ": [1, 2, 4, 14, 15, 17, 18], "simpl": [1, 2, 14, 17, 18], "user": [1, 2, 8, 11, 14, 16, 17, 18], "s": [1, 2, 4, 11, 14, 17, 18], "myevalunit": 1, "batch": [1, 2, 14, 16, 17, 18], "__init__": [1, 2, 14, 18], "modul": [1, 2, 7, 10, 14, 15, 16, 17, 18], "torch": [1, 2, 8, 10, 14, 16, 17, 18], "nn": [1, 2, 14, 16, 18], "super": [1, 2, 14, 16, 18], "data": [1, 2, 12, 14, 15, 16, 18], "input": [1, 2, 14, 17, 18], "target": [1, 2, 14, 18], "output": [1, 2, 3, 14, 16, 18], "loss": [1, 2, 16, 18], "binary_cross_entropy_with_logit": [1, 2, 18], "eval_unit": [1, 16], "The": [1, 2, 3, 4, 7, 14, 16, 17, 18], "take": [1, 2, 4, 11, 14, 16, 18], "object": [1, 2, 14, 16, 17, 18], "list": [1, 2, 3, 6, 7, 11, 14, 16, 17, 18], "callback": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18], "initi": [1, 2, 9, 14, 16, 17, 18], "init_eval_st": [1, 16], "dataload": [1, 2, 5, 11, 14, 16, 17, 18], "iter": [1, 2, 14, 16, 17, 18], "includ": [1, 2, 14, 15, 16, 17, 18], "pytorch": [1, 2, 7, 8, 10, 11, 12, 13, 14, 16, 17, 18], "numpi": [1, 2, 14, 17, 18], "etc": [1, 2, 7, 14, 17, 18], "some": [1, 2, 14, 18], "durat": [1, 2, 14, 18], "abov": [1, 2, 14, 18], "optim": [1, 2, 6, 14, 16, 18], "lr_schedul": [1, 2, 14, 16, 18], "util": [1, 2, 10, 11, 12, 14, 15, 16, 18], "max_steps_per_epoch": [1, 14, 16], "20": [1, 14], "interleav": [2, 16, 17], "give": 2, "immedi": 2, "feedback": 2, "about": [2, 16], "how": [2, 16, 17], "model": [2, 4, 16, 17], "perform": [2, 4], "while": [2, 17], "For": [2, 11, 16, 17], "train_step": [2, 16, 18], "on_train_epoch_end": [2, 5, 16, 18], "myfitunit": 2, "_lrschedul": [2, 18], "backward": [2, 16, 18], "zero_grad": [2, 18], "learn": [2, 6, 18], "rate": [2, 6, 9, 18], "schedul": [2, 6, 18], "fit_unit": 2, "both": [2, 16], "init_fit_st": [2, 16], "eval_dataload": [2, 16], "max_epoch": [2, 16, 18], "4": [2, 17, 18], "header_row": 3, "str": [3, 6, 7, 11, 16, 17], "dir_path": 3, "delimit": 3, "t": [3, 17], "filenam": 3, "csv": 3, "write": [3, 17], "file": [3, 17], "thi": [3, 4, 11, 16, 17], "provid": [3, 11, 17], "simplifi": [3, 15], "extend": 3, "get_step_output_row": 3, "desir": 3, "row": 3, "By": [3, 4, 11, 16, 17], "default": [3, 4, 7, 11, 16, 17], "each": [3, 4, 5, 6, 16, 17], "all": [3, 4, 7, 11, 17], "process": [3, 4, 11, 17], "same": [3, 4, 11, 17], "string": [3, 16, 17], "should": [3, 11, 16, 17], "match": 3, "column": 3, "name": [3, 7, 11, 17], "defin": [3, 17], "directori": [3, 11], "path": [3, 11, 17], "where": [3, 17], "save": [3, 11, 17], "separ": [3, 17], "one": [3, 17], "tab": 3, "step_interv": 4, "int": [4, 7, 9, 11, 16, 17], "period": [4, 11, 17], "synchron": [4, 17], "garbag": 4, "collect": [4, 17], "fulli": 4, "distribut": [4, 9, 17], "program": [4, 17], "multipl": [4, 17], "These": 4, "commun": 4, "other": [4, 17], "especi": 4, "gradient": [4, 16], "updat": [4, 9, 13, 16], "overal": 4, "therefor": 4, "gate": 4, "slowest": 4, "As": 4, "result": [4, 17], "roughli": 4, "amount": 4, "time": [4, 17], "its": 4, "otherwis": [4, 17], "straggler": 4, "python": [4, 17], "automat": 4, "trigger": 4, "possibl": 4, "make": [4, 13, 17], "conveni": [4, 16, 17], "lead": 4, "improv": [4, 16, 17], "frequenc": [4, 11], "tune": 4, "base": [4, 16, 17], "applic": [4, 11, 17], "hand": 4, "number": [4, 9, 11, 16, 17], "befor": 4, "on_except": 5, "callabl": [5, 7], "union": [5, 6, 10, 16, 17], "trainunit": [5, 11, 16], "ttraindata": [5, 11, 16], "evalunit": [5, 16], "tevaldata": [5, 16], "predictunit": [5, 16], "tpredictdata": [5, 16], "baseexcept": [5, 17], "on_train_epoch_start": [5, 16], "on_train_step_start": 5, "on_train_step_end": 5, "on_eval_epoch_start": [5, 16], "on_eval_step_start": 5, "on_eval_step_end": 5, "on_eval_epoch_end": [5, 16], "on_predict_epoch_start": [5, 16], "on_predict_step_start": 5, "on_predict_step_end": 5, "on_predict_epoch_end": [5, 16], "accept": 5, "except": [5, 17], "occur": 5, "epoch": [5, 6, 11, 16], "eval": [5, 11, 16], "mydataload": 5, "myunit": 5, "print_on_step_start": 5, "f": [5, 17], "eval_st": [5, 16], "progress": [5, 9, 11, 16], "num_steps_complet": [5, 16], "lambda_cb": 5, "arg": [5, 7, 17], "logger": [6, 10, 12], "metriclogg": [6, 17], "logging_interv": 6, "log": [6, 7, 10, 15, 16, 17], "track": [6, 16], "group": [6, 17], "associ": 6, "either": [6, 10, 16, 17], "param": [6, 16], "max_depth": 7, "type": [7, 17], "process_fn": 7, "torchev": 7, "tool": [7, 12], "module_summari": 7, "_log_module_summary_t": 7, "module_input": 7, "mutablemap": 7, "tupl": [7, 16], "dict": [7, 16, 17], "gener": [7, 11, 16, 17], "summari": [7, 17], "requir": [7, 17], "http": [7, 8, 10, 11, 13, 16, 17], "org": [7, 8, 10, 11, 16, 17], "stabl": [7, 8, 10, 16, 17], "maximum": 7, "depth": 7, "keep": 7, "tabl": 7, "map": [7, 17], "kwarg": [7, 17], "want": [7, 11], "flop": 7, "activ": 7, "size": [7, 17], "rais": [7, 17], "runtimeerror": [7, 17], "If": [7, 11, 13, 17], "instal": [7, 12], "profil": [8, 17], "doc": [8, 10, 16, 17], "html": [8, 10, 11, 16, 17], "context": [8, 17], "manag": [8, 11, 17], "refresh_r": 9, "1": [9, 16, 17], "bar": 9, "visual": 9, "It": [9, 17], "onli": [9, 16, 17], "rank": [9, 17], "0": [9, 16, 17], "environ": [9, 17], "determin": [9, 17], "get": [9, 17], "tensorboardlogg": [10, 17], "summarywrit": [10, 17], "histogram": 10, "tensorboard": [10, 17], "writer": [10, 17], "instanc": [10, 16, 17], "dirpath": 11, "save_every_n_train_step": 11, "save_every_n_epoch": 11, "replic": 11, "torchsnapshot": 11, "appstatemixin": 11, "random": [11, 17], "also": [11, 13, 17], "parent": [11, 16], "snapshot": 11, "intra": 11, "glob": 11, "pattern": 11, "kei": [11, 17], "indic": [11, 17], "have": [11, 16, 17], "more": [11, 16, 17], "inform": [11, 17], "see": [11, 17], "main": [11, 15], "api_refer": 11, "valid": 11, "collis": 11, "app": [11, 17], "static": 11, "restor": 11, "restore_train_progress": 11, "bool": [11, 16, 17], "true": [11, 17], "restore_train_dataload": 11, "restore_eval_progress": 11, "sinc": [11, 17], "handl": [11, 16, 17], "There": 11, "flag": 11, "skip": [11, 17], "load": [11, 17], "tnt": [12, 13], "librari": [12, 17], "project": 12, "structur": 12, "pip": 13, "do": 13, "so": 13, "issu": [13, 17], "sure": 13, "first": 13, "latest": 13, "version": [13, 17], "master": 13, "just": 13, "git": 13, "github": 13, "com": 13, "upgrad": 13, "predict_step": [14, 16], "mypredictunit": 14, "predict_unit": [14, 16], "init_predict_st": [14, 16], "ha": [15, 17], "two": [15, 17], "compon": 15, "top": 15, "level": 15, "repo": 15, "contain": [15, 16, 17], "lightweight": 15, "maintain": 15, "grab": 15, "bag": 15, "independ": 15, "relat": [15, 17], "abstract": [15, 16, 17], "wrapper": [15, 17], "around": [15, 17], "publish": 15, "metric": [15, 16, 17], "autounit": 16, "lrschedul": [16, 17], "step_lr_interv": 16, "liter": [16, 17], "devic": [16, 17], "log_frequency_step": 16, "1000": 16, "precis": [16, 17], "dtype": 16, "gradient_accumulation_step": 16, "detect_anomali": 16, "fals": [16, 17], "clip_grad_norm": 16, "float": [16, 17], "clip_grad_valu": 16, "swa_param": 16, "swaparam": 16, "torchdynamo_param": 16, "torchdynamoparam": 16, "who": 16, "stochast": 16, "descent": 16, "would": 16, "like": [16, 17], "them": [16, 17], "forward": 16, "part": 16, "comput": [16, 17], "benefit": 16, "compute_loss": 16, "update_metr": 16, "log_metr": 16, "Then": 16, "normal": 16, "advanc": 16, "directli": [16, 17], "whether": [16, 17], "everi": 16, "often": 16, "term": 16, "mani": 16, "accumul": 16, "over": [16, 17], "enabl": [16, 17], "anomali": 16, "detect": 16, "autograd": 16, "engin": 16, "max": [16, 17], "norm": [16, 17], "clip": 16, "clip_grad_norm_": 16, "valu": [16, 17], "clip_grad_value_": 16, "weight": [16, 17], "averag": 16, "torchdynamo": 16, "grad_scal": 16, "cuda": [16, 17], "amp": 16, "gradscal": 16, "fp16": 16, "num_optimizer_steps_complet": 16, "complet": 16, "support": [16, 17], "avail": [16, 17], "2": [16, 17], "higher": 16, "tdata": 16, "tensor": [16, 17], "return": [16, 17], "decor": 16, "inference_mod": 16, "peform": 16, "interv": [16, 17], "been": [16, 17], "i": [16, 17], "e": 16, "move_data_to_devic": 16, "overrid": 16, "copi": [16, 17], "copy_data_to_devic": [16, 17], "properti": [16, 17], "note": [16, 17], "swa": 16, "phasest": 16, "max_step": 16, "evaluate_every_n_step": 16, "evaluate_every_n_epoch": 16, "phase": 16, "is_last_batch": 16, "step_output": 16, "num_epochs_complet": 16, "num_steps_completed_in_epoch": 16, "state_dict": [16, 17], "load_state_dict": [16, 17], "checkpoint": [16, 17], "increment_epoch": 16, "increment_step": 16, "entry_point": 16, "entrypoint": 16, "timer": [16, 17], "train_stat": 16, "predict_st": 16, "up": 16, "3": [16, 17], "active_phas": 16, "activephas": 16, "should_stop": 16, "read": [16, 17], "termin": 16, "after": [16, 17], "current": [16, 17], "stop": [16, 17], "signal": [16, 17], "metadata": 16, "helper": 16, "per": 16, "mean": 16, "until": [16, 17], "exhaust": [16, 17], "max_train_steps_per_epoch": 16, "max_eval_steps_per_epoch": 16, "limit": 16, "infinit": [16, 17], "unless": 16, "init_train_st": [16, 18], "cpustat": 17, "_typenam": 17, "_field": 17, "cpu_perc": 17, "cpu_swap_perc": 17, "cpu_vm_perc": 17, "earlystopcheck": 17, "mode": 17, "min": 17, "patienc": 17, "min_delta": 17, "check_finit": 17, "threshold_mod": 17, "ab": 17, "rel": 17, "stopping_threshold": 17, "divergence_threshold": 17, "monitor": 17, "earli": 17, "given": 17, "decreas": 17, "increas": 17, "check": 17, "without": 17, "minimum": 17, "absolut": 17, "chang": 17, "qualifi": 17, "improvement_threshold": 17, "best_val": 17, "threshold": 17, "set": 17, "becom": 17, "nan": 17, "delta": 17, "between": 17, "onc": 17, "beyond": 17, "wors": 17, "than": 17, "valueerror": 17, "val": 17, "singl": 17, "element": 17, "boolean": 17, "doe": 17, "reset": 17, "back": 17, "reload": 17, "fullsyncperiodictim": 17, "timedelta": 17, "cpu_pg": 17, "processgroup": 17, "measur": 17, "elaps": 17, "propag": 17, "done": 17, "asynchron": 17, "previou": 17, "order": 17, "avoid": 17, "block": 17, "gpustat": 17, "fan_speed_perc": 17, "memory_free_mb": 17, "memory_used_mb": 17, "temperature_gpu_celsiu": 17, "temperature_memory_celsiu": 17, "utilization_gpu_perc": 17, "utilization_memory_perc": 17, "pgwrapper": 17, "pg": 17, "consist": 17, "fashion": 17, "regardless": 17, "follow": 17, "scenario": 17, "world": 17, "all_gather_object": 17, "obj_list": 17, "obj": 17, "barrier": 17, "broadcast_object_list": 17, "src": 17, "get_rank": 17, "get_world_s": 17, "scatter_object_list": 17, "output_list": 17, "input_list": 17, "rssprofil": 17, "datetim": 17, "microsecond": 17, "100000": 17, "rss": 17, "resid": 17, "baselin": 17, "store": 17, "rss_deltas_byt": 17, "100m": 17, "byte": 17, "round": 17, "captur": 17, "thread": 17, "empti": 17, "tlrschedul": 17, "alia": 17, "record": 17, "well": 17, "cumul": 17, "second": 17, "interval_time_second": 17, "most": 17, "recent": 17, "still": 17, "now": 17, "paus": 17, "export": 17, "ad": 17, "total": 17, "action_nam": 17, "yield": 17, "encapsul": 17, "scope": 17, "action": 17, "under": 17, "what": 17, "enclos": 17, "total_time_second": 17, "sum": 17, "last": 17, "all_gather_tensor": 17, "gather": 17, "onto": 17, "broadcast": 17, "work": 17, "dimens": 17, "mai": 17, "case": 17, "pad": 17, "trim": 17, "secur": 17, "equal": 17, "workload": 17, "sync": 17, "gathered_result": 17, "correspond": 17, "recurs": 17, "posit": 17, "argument": 17, "keyword": 17, "correct": 17, "days_to_sec": 17, "dai": 17, "convert": 17, "get_device_from_env": 17, "cpu": 17, "gpu": 17, "within": 17, "reli": 17, "local_rank": 17, "variabl": 17, "made": 17, "launcher": 17, "appropri": 17, "index": 17, "outsid": 17, "rang": 17, "get_filesystem": 17, "abstractfilesystem": 17, "filesystem": 17, "get_global_rank": 17, "env": 17, "var": 17, "instead": 17, "neither": 17, "condit": 17, "met": 17, "get_nvidia_smi_gpu_stat": 17, "stat": 17, "nvidia": 17, "smi": 17, "filenotfounderror": 17, "command": 17, "found": 17, "get_process_group_backend_from_devic": 17, "backend": 17, "get_psutil_cpu_stat": 17, "psutil": 17, "get_python_vers": 17, "runtim": 17, "8": 17, "get_tensor_size_bytes_map": 17, "get_timer_summari": 17, "get_torch_vers": 17, "12": 17, "init_from_env": 17, "device_typ": 17, "pg_backend": 17, "pg_timeout": 17, "1800": 17, "float32_matmul_precis": 17, "high": 17, "global": 17, "alreadi": 17, "launch": 17, "intend": 17, "begin": 17, "script": 17, "spmd": 17, "style": 17, "timeout": 17, "oper": 17, "against": 17, "30": 17, "minut": 17, "matrix": 17, "is_out_of_cpu_memori": 17, "oom": 17, "is_out_of_cuda_memori": 17, "is_out_of_memory_error": 17, "due": 17, "error": 17, "is_torch_version_ge_1_13_1": 17, "is_torch_version_geq_1_10": 17, "is_torch_version_geq_1_11": 17, "is_torch_version_geq_1_12": 17, "is_torch_version_geq_1_13": 17, "is_torch_version_geq_1_14": 17, "is_torch_version_geq_1_8": 17, "is_torch_version_geq_1_9": 17, "is_torch_version_geq_2_0": 17, "is_window": 17, "Is": 17, "window": 17, "system": 17, "maybe_enable_tf32": 17, "condition": 17, "float32": 17, "datatyp": 17, "measure_rss_delta": 17, "rss_delta": 17, "append": 17, "rank_zero_crit": 17, "rank_zero_debug": 17, "rank_zero_error": 17, "rank_zero_info": 17, "rank_zero_print": 17, "rank_zero_warn": 17, "seed": 17, "determinist": 17, "pseudo": 17, "commonli": 17, "detail": 17, "integ": 17, "don": 17, "warn": 17, "nondeterminist": 17, "addition": 17, "cudnn": 17, "benchmark": 17, "disabl": 17, "set_deterministic_debug_mod": 17, "algorithm": 17, "sync_bool": 17, "coherence_mod": 17, "rank_zero": 17, "member": 17, "specifi": 17, "manner": 17, "5": 17, "receiv": 17, "sourc": 17, "truth": 17, "n": 17, "least": 17, "ratio": 17, "synced_v": 17, "iff": 17, "success": 17, "transfer_batch_norm_stat": 17, "src_modul": 17, "dst_modul": 17, "transfer": 17, "statist": 17, "transfer_weight": 17, "alldatasetbatchesiter": 17, "individual_dataload": 17, "iteration_strategi": 17, "alldatasetbatch": 17, "mechan": 17, "all_datasets_exhaust": 17, "finish": 17, "dataset": 17, "three": 17, "till": 17, "largest": 17, "those": 17, "smallest_dataset_exhaust": 17, "smallest": 17, "restart_until_all_datasets_exhaust": 17, "restart": 17, "format": 17, "dataloader_1_nam": 17, "batch_obtained_from_dataloader_1": 17, "dataloader_2_nam": 17, "batch_obtained_from_dataloader_2": 17, "dataclass": 17, "loader": 17, "batch_siz": 17, "b": 17, "15": 17, "all_dataset_batch_strategi": 17, "stopping_mechan": 17, "stoppingmechan": 17, "combined_iter": 17, "item": 17, "6": 17, "7": 17, "9": 17, "10": 17, "11": 17, "13": 17, "14": 17, "cudadataprefetch": 17, "data_iter": 17, "num_prefetch_batch": 17, "prefetch": 17, "move": 17, "host": 17, "effect": 17, "construct": 17, "recommend": 17, "leverag": 17, "memori": 17, "pin": 17, "data_prefetch": 17, "dataiterationstrategi": 17, "dataiterationstrategyregistri": 17, "registri": 17, "roundrobin": 17, "roundrobiniter": 17, "randomizedbatchsampl": 17, "randomizedbatchsampleriter": 17, "inord": 17, "inorderiter": 17, "classmethod": 17, "multiiter": 17, "next": 17, "overridden": 17, "repetit": 17, "dataloader_nam": 17, "batch_from_dataload": 17, "in_order_strategi": 17, "multidataload": 17, "iterator_cl": 17, "ignore_empty_data": 17, "cycl": 17, "through": 17, "individu": 17, "dictionari": 17, "torchdata": 17, "beta": 17, "multi": 17, "achiev": 17, "mux": 17, "mux_longest": 17, "zip": 17, "pleas": 17, "refer": 17, "document": 17, "accompani": 17, "particular": 17, "randomli": 17, "sampl": 17, "anoth": 17, "randomized_batch_sampl": 17, "via": 17, "robinrobin": 17, "strategi": 17, "round_robin_strategi": 17, "csvlogger": 17, "steps_before_flush": 17, "100": 17, "log_all_rank": 17, "close": 17, "resourc": 17, "flush": 17, "necessari": 17, "filelogg": 17, "ndarrai": 17, "scalar": 17, "uniqu": 17, "log_dict": 17, "payload": 17, "tag": 17, "inmemorylogg": 17, "buffer": 17, "log_buff": 17, "access": 17, "jsonlogg": 17, "accuraci": 17, "23": 17, "56": 17, "pend": 17, "disk": 17, "cannot": 17, "log_hparam": 17, "hparam": 17, "hyperparamet": 17, "log_text": 17, "text": 17, "identifi": 17, "scalar_to_float": 17, "mytrainunit": 18}, "objects": {"torchtnt": [[16, 0, 0, "-", "framework"], [17, 0, 0, "-", "utils"]], "torchtnt.framework": [[16, 1, 1, "", "AutoUnit"], [16, 1, 1, "", "Callback"], [16, 1, 1, "", "EvalUnit"], [16, 1, 1, "", "PhaseState"], [16, 1, 1, "", "PredictUnit"], [16, 1, 1, "", "Progress"], [16, 1, 1, "", "State"], [16, 1, 1, "", "TrainUnit"], [0, 0, 0, "-", "callback"], [16, 5, 1, "", "evaluate"], [16, 5, 1, "", "fit"], [16, 5, 1, "", "init_eval_state"], [16, 5, 1, "", "init_fit_state"], [16, 5, 1, "", "init_predict_state"], [16, 5, 1, "", "init_train_state"], [16, 5, 1, "", "predict"], [16, 5, 1, "", "train"]], "torchtnt.framework.AutoUnit": [[16, 2, 1, "", "clip_grad_norm"], [16, 2, 1, "", "clip_grad_value"], [16, 3, 1, "", "compute_loss"], [16, 2, 1, "", "detect_anomaly"], [16, 2, 1, "", "device"], [16, 3, 1, "", "eval_step"], [16, 2, 1, "", "grad_scaler"], [16, 2, 1, "", "gradient_accumulation_steps"], [16, 2, 1, "", "log_frequency_steps"], [16, 3, 1, "", "log_metrics"], [16, 2, 1, "", "lr_scheduler"], [16, 2, 1, "", "module"], [16, 3, 1, "", "move_data_to_device"], [16, 4, 1, "id0", "num_optimizer_steps_completed"], [16, 3, 1, "", "on_eval_epoch_end"], [16, 3, 1, "", "on_train_end"], [16, 3, 1, "", "on_train_epoch_end"], [16, 2, 1, "", "optimizer"], [16, 2, 1, "", "precision"], [16, 3, 1, "", "predict_step"], [16, 2, 1, "", "step_lr_interval"], [16, 2, 1, "", "swa_params"], [16, 2, 1, "", "torchdynamo_params"], [16, 3, 1, "", "train_step"], [16, 3, 1, "", "update_metrics"]], "torchtnt.framework.EvalUnit": [[16, 3, 1, "", "eval_step"], [16, 3, 1, "", "on_eval_end"], [16, 3, 1, "", "on_eval_epoch_end"], [16, 3, 1, "", "on_eval_epoch_start"], [16, 3, 1, "", "on_eval_start"]], "torchtnt.framework.PhaseState": [[16, 4, 1, "", "dataloader"], [16, 4, 1, "", "evaluate_every_n_epochs"], [16, 4, 1, "", "evaluate_every_n_steps"], [16, 4, 1, "", "is_last_batch"], [16, 4, 1, "", "max_epochs"], [16, 4, 1, "", "max_steps"], [16, 4, 1, "", "max_steps_per_epoch"], [16, 4, 1, "", "progress"], [16, 4, 1, "", "step_output"]], "torchtnt.framework.PredictUnit": [[16, 3, 1, "", "on_predict_end"], [16, 3, 1, "", "on_predict_epoch_end"], [16, 3, 1, "", "on_predict_epoch_start"], [16, 3, 1, "", "on_predict_start"], [16, 3, 1, "", "predict_step"]], "torchtnt.framework.Progress": [[16, 3, 1, "", "increment_epoch"], [16, 3, 1, "", "increment_step"], [16, 3, 1, "", "load_state_dict"], [16, 4, 1, "", "num_epochs_completed"], [16, 4, 1, "", "num_steps_completed"], [16, 4, 1, "", "num_steps_completed_in_epoch"], [16, 3, 1, "", "state_dict"]], "torchtnt.framework.State": [[16, 4, 1, "", "active_phase"], [16, 4, 1, "", "entry_point"], [16, 4, 1, "", "eval_state"], [16, 4, 1, "", "predict_state"], [16, 4, 1, "", "should_stop"], [16, 3, 1, "", "stop"], [16, 4, 1, "", "timer"], [16, 4, 1, "", "train_state"]], "torchtnt.framework.TrainUnit": [[16, 3, 1, "", "on_train_end"], [16, 3, 1, "", "on_train_epoch_end"], [16, 3, 1, "", "on_train_epoch_start"], [16, 3, 1, "", "on_train_start"], [16, 3, 1, "", "train_step"]], "torchtnt.framework.callback": [[0, 1, 1, "", "Callback"]], "torchtnt.framework.callbacks": [[3, 1, 1, "", "BaseCSVWriter"], [4, 1, 1, "", "GarbageCollector"], [5, 1, 1, "", "Lambda"], [6, 1, 1, "", "LearningRateMonitor"], [7, 1, 1, "", "ModuleSummary"], [8, 1, 1, "", "PyTorchProfiler"], [9, 1, 1, "", "TQDMProgressBar"], [10, 1, 1, "", "TensorBoardParameterMonitor"], [11, 1, 1, "", "TorchSnapshotSaver"]], "torchtnt.framework.callbacks.TorchSnapshotSaver": [[11, 3, 1, "", "on_train_start"], [11, 3, 1, "", "restore"]], "torchtnt.utils": [[17, 1, 1, "", "CPUStats"], [17, 1, 1, "", "EarlyStopChecker"], [17, 1, 1, "", "FullSyncPeriodicTimer"], [17, 1, 1, "", "GPUStats"], [17, 1, 1, "", "PGWrapper"], [17, 1, 1, "", "RSSProfiler"], [17, 2, 1, "", "TLRScheduler"], [17, 1, 1, "", "Timer"], [17, 5, 1, "", "all_gather_tensors"], [17, 5, 1, "", "copy_data_to_device"], [17, 0, 0, "-", "data"], [17, 5, 1, "", "days_to_secs"], [17, 5, 1, "", "get_device_from_env"], [17, 5, 1, "", "get_filesystem"], [17, 5, 1, "", "get_global_rank"], [17, 5, 1, "", "get_nvidia_smi_gpu_stats"], [17, 5, 1, "", "get_process_group_backend_from_device"], [17, 5, 1, "", "get_psutil_cpu_stats"], [17, 5, 1, "", "get_python_version"], [17, 5, 1, "", "get_tensor_size_bytes_map"], [17, 5, 1, "", "get_timer_summary"], [17, 5, 1, "", "get_torch_version"], [17, 5, 1, "", "init_from_env"], [17, 5, 1, "", "is_out_of_cpu_memory"], [17, 5, 1, "", "is_out_of_cuda_memory"], [17, 5, 1, "", "is_out_of_memory_error"], [17, 5, 1, "", "is_torch_version_ge_1_13_1"], [17, 5, 1, "", "is_torch_version_geq_1_10"], [17, 5, 1, "", "is_torch_version_geq_1_11"], [17, 5, 1, "", "is_torch_version_geq_1_12"], [17, 5, 1, "", "is_torch_version_geq_1_13"], [17, 5, 1, "", "is_torch_version_geq_1_14"], [17, 5, 1, "", "is_torch_version_geq_1_8"], [17, 5, 1, "", "is_torch_version_geq_1_9"], [17, 5, 1, "", "is_torch_version_geq_2_0"], [17, 5, 1, "", "is_windows"], [17, 0, 0, "-", "loggers"], [17, 5, 1, "", "maybe_enable_tf32"], [17, 5, 1, "", "measure_rss_deltas"], [17, 5, 1, "", "rank_zero_critical"], [17, 5, 1, "", "rank_zero_debug"], [17, 5, 1, "", "rank_zero_error"], [17, 5, 1, "", "rank_zero_info"], [17, 5, 1, "", "rank_zero_print"], [17, 5, 1, "", "rank_zero_warn"], [17, 5, 1, "", "seed"], [17, 5, 1, "", "sync_bool"], [17, 5, 1, "", "transfer_batch_norm_stats"], [17, 5, 1, "", "transfer_weights"]], "torchtnt.utils.CPUStats": [[17, 2, 1, "", "cpu_percent"], [17, 2, 1, "", "cpu_swap_percent"], [17, 2, 1, "", "cpu_vm_percent"]], "torchtnt.utils.EarlyStopChecker": [[17, 3, 1, "", "check"], [17, 4, 1, "", "check_finite"], [17, 4, 1, "", "divergence_threshold"], [17, 3, 1, "", "load_state_dict"], [17, 4, 1, "", "min_delta"], [17, 4, 1, "", "mode"], [17, 4, 1, "", "patience"], [17, 3, 1, "", "reset"], [17, 3, 1, "", "state_dict"], [17, 4, 1, "", "stopping_threshold"], [17, 4, 1, "", "threshold_mode"]], "torchtnt.utils.FullSyncPeriodicTimer": [[17, 3, 1, "", "check"]], "torchtnt.utils.GPUStats": [[17, 2, 1, "", "fan_speed_percent"], [17, 2, 1, "", "memory_free_mb"], [17, 2, 1, "", "memory_used_mb"], [17, 2, 1, "", "temperature_gpu_celsius"], [17, 2, 1, "", "temperature_memory_celsius"], [17, 2, 1, "", "utilization_gpu_percent"], [17, 2, 1, "", "utilization_memory_percent"]], "torchtnt.utils.PGWrapper": [[17, 3, 1, "", "all_gather_object"], [17, 3, 1, "", "barrier"], [17, 3, 1, "", "broadcast_object_list"], [17, 3, 1, "", "get_rank"], [17, 3, 1, "", "get_world_size"], [17, 3, 1, "", "scatter_object_list"]], "torchtnt.utils.RSSProfiler": [[17, 2, 1, "", "interval"], [17, 3, 1, "", "profile"], [17, 3, 1, "", "reset"], [17, 2, 1, "", "rss_deltas_bytes"]], "torchtnt.utils.Timer": [[17, 4, 1, "", "interval_time_seconds"], [17, 3, 1, "", "load_state_dict"], [17, 4, 1, "", "paused"], [17, 3, 1, "", "reset"], [17, 3, 1, "", "start"], [17, 3, 1, "", "state_dict"], [17, 3, 1, "", "stop"], [17, 3, 1, "", "time"], [17, 4, 1, "", "total_time_seconds"]], "torchtnt.utils.data": [[17, 1, 1, "", "AllDatasetBatchesIterator"], [17, 1, 1, "", "CudaDataPrefetcher"], [17, 1, 1, "", "DataIterationStrategy"], [17, 1, 1, "", "DataIterationStrategyRegistry"], [17, 1, 1, "", "InOrderIterator"], [17, 1, 1, "", "MultiDataLoader"], [17, 1, 1, "", "MultiIterator"], [17, 1, 1, "", "RandomizedBatchSamplerIterator"], [17, 1, 1, "", "RoundRobinIterator"]], "torchtnt.utils.data.DataIterationStrategyRegistry": [[17, 2, 1, "", "REGISTRY"], [17, 3, 1, "", "get"]], "torchtnt.utils.data.MultiDataLoader": [[17, 2, 1, "", "ignore_empty_data"], [17, 2, 1, "", "individual_dataloaders"], [17, 2, 1, "", "iteration_strategy"], [17, 2, 1, "", "iterator_cls"]], "torchtnt.utils.loggers": [[17, 1, 1, "", "CSVLogger"], [17, 1, 1, "", "FileLogger"], [17, 1, 1, "", "InMemoryLogger"], [17, 1, 1, "", "JSONLogger"], [17, 1, 1, "", "MetricLogger"], [17, 1, 1, "", "TensorBoardLogger"], [17, 5, 1, "", "scalar_to_float"]], "torchtnt.utils.loggers.CSVLogger": [[17, 3, 1, "", "close"], [17, 3, 1, "", "flush"]], "torchtnt.utils.loggers.FileLogger": [[17, 3, 1, "", "close"], [17, 3, 1, "", "flush"], [17, 3, 1, "", "log"], [17, 3, 1, "", "log_dict"], [17, 4, 1, "", "path"]], "torchtnt.utils.loggers.InMemoryLogger": [[17, 3, 1, "", "close"], [17, 3, 1, "", "flush"], [17, 3, 1, "", "log"], [17, 4, 1, "", "log_buffer"], [17, 3, 1, "", "log_dict"]], "torchtnt.utils.loggers.JSONLogger": [[17, 3, 1, "", "close"], [17, 3, 1, "", "flush"]], "torchtnt.utils.loggers.MetricLogger": [[17, 3, 1, "", "close"], [17, 3, 1, "", "log"], [17, 3, 1, "", "log_dict"]], "torchtnt.utils.loggers.TensorBoardLogger": [[17, 3, 1, "", "close"], [17, 3, 1, "", "flush"], [17, 3, 1, "", "log"], [17, 3, 1, "", "log_dict"], [17, 3, 1, "", "log_hparams"], [17, 3, 1, "", "log_text"], [17, 4, 1, "", "path"], [17, 4, 1, "", "writer"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:attribute", "3": "py:method", "4": "py:property", "5": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "attribute", "Python attribute"], "3": ["py", "method", "Python method"], "4": ["py", "property", "Python property"], "5": ["py", "function", "Python function"]}, "titleterms": {"callback": 0, "what": 0, "how": 0, "us": 0, "built": 0, "write": 0, "your": 0, "own": 0, "evalu": 1, "evalunit": [1, 2], "entri": [1, 2, 14, 18], "point": [1, 2, 14, 18], "fit": 2, "trainunit": [2, 18], "basecsvwrit": 3, "garbagecollector": 4, "lambda": 5, "learningratemonitor": 6, "modulesummari": 7, "pytorchprofil": 8, "tqdmprogressbar": 9, "tensorboardparametermonitor": 10, "torchsnapshotsav": 11, "welcom": 12, "torchtnt": 12, "document": 12, "overview": 12, "framework": [12, 16], "api": 12, "instal": 13, "predict": 14, "predictunit": 14, "project": 15, "structur": 15, "util": 17, "data": 17, "logger": 17, "train": 18}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})